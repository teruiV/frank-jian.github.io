<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta name="baidu-site-verification" content="Y1BuCj8QZI" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="æ¯å¤©è¿›æ­¥ä¸€ç‚¹">
<meta property="og:type" content="website">
<meta property="og:title" content="è®°å½•ç‚¹æ»´æˆé•¿">
<meta property="og:url" content="http://jianwl.com/page/4/index.html">
<meta property="og:site_name" content="è®°å½•ç‚¹æ»´æˆé•¿">
<meta property="og:description" content="æ¯å¤©è¿›æ­¥ä¸€ç‚¹">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="è®°å½•ç‚¹æ»´æˆé•¿">
<meta name="twitter:description" content="æ¯å¤©è¿›æ­¥ä¸€ç‚¹">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: 'åšä¸»'
    }
  };
</script>




  <link rel="canonical" href="http://jianwl.com/page/4/"/>

  <title> è®°å½•ç‚¹æ»´æˆé•¿ </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">è®°å½•ç‚¹æ»´æˆé•¿</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            å…³äº
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-books">
          <a href="/books" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            ä¹¦å•
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            æœç´¢
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/08/MysqlæœåŠ¡å¯åŠ¨é”™è¯¯-The-server-quit-without-updating-PID-file/" itemprop="url">
                  MysqlæœåŠ¡å¯åŠ¨é”™è¯¯ The server quit without updating PID file
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">å‘è¡¨äº</span>
            <time itemprop="dateCreated" datetime="2016-09-08T11:39:19+08:00" content="2016-09-08">
              2016-09-08
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/08/MysqlæœåŠ¡å¯åŠ¨é”™è¯¯-The-server-quit-without-updating-PID-file/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/08/MysqlæœåŠ¡å¯åŠ¨é”™è¯¯-The-server-quit-without-updating-PID-file/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h3><p>æœ¬åœ°MySQLä¸€ç›´éƒ½èƒ½å¤Ÿæ­£å¸¸å¯åŠ¨çš„ï¼Œæ˜¨æ™šå…³æœºäº†Macï¼Œä»Šæ—©å¯åŠ¨MySQL,å‡ºé”™äº†ã€‚</p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-8/77573533.jpg" alt=""></p>
<h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p>åˆ é™¤ä¸‹é¢è¿™ä¸ªé”™è¯¯æ–‡ä»¶å°±å¯ä»¥äº†<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo rm -rf /usr/local/var/mysql/jianweilindeMacBook-Pro.local.err</div></pre></td></tr></table></figure></p>
<h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-8/23129111.jpg" alt=""></p>
<p>ç”±äº<code>jianweilindeMacBook-Pro.local.err</code>çš„ç”¨æˆ·æƒé™æ˜¯<code>_mysql</code>,è€Œä¸æ˜¯æˆ‘è‡ªå·±çš„ç”¨æˆ·æƒé™ï¼Œæ•…å¯åŠ¨çš„æ—¶å€™ä¼šæŠ¥é”™ã€‚åˆ é™¤è¿™ä¸ªæ–‡ä»¶æˆ–ä¿®æ”¹ç”¨æˆ·æƒé™å‡å¯ã€‚</p>
<h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><ul>
<li><a href="http://pein0119.github.io/2015/03/25/MySQL%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%90%AF%E5%8A%A8%E9%94%99%E8%AF%AF-The-server-quit-without-updating-PID-file/" target="_blank" rel="external">MySQLæœåŠ¡å™¨å¯åŠ¨é”™è¯¯<code>The server quit without updating PID file</code></a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/07/ES6ä¹‹æ•°ç»„çš„æ‰©å±•/" itemprop="url">
                  ES6ä¹‹æ•°ç»„çš„æ‰©å±•
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">å‘è¡¨äº</span>
            <time itemprop="dateCreated" datetime="2016-09-07T00:17:28+08:00" content="2016-09-07">
              2016-09-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JavaScript/" itemprop="url" rel="index">
                    <span itemprop="name">JavaScript</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/07/ES6ä¹‹æ•°ç»„çš„æ‰©å±•/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/07/ES6ä¹‹æ•°ç»„çš„æ‰©å±•/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>ä¸Šç¯‡æ–‡ç« ä»‹ç»äº†<a href="http://jianwl.com/2016/09/06/ES6%E4%B9%8B%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%89%A9%E5%B1%95/">ES6ä¹‹å­—ç¬¦ä¸²çš„æ‰©å±•</a>ï¼Œæœ¬æ–‡å°†å­¦ä¹ ES6ä¸­æ•°ç»„çš„æ‰©å±•ï¼Œæ•°ç»„åœ¨å®é™…é¡¹ç›®ä¸­æ¯”è¾ƒå¸¸ç”¨ï¼Œæ‰€ä»¥éå¸¸æœ‰å¿…è¦äº†è§£ä¸€ä¸‹ã€‚</p>
<h3 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h3><p><strong>å°†æ•°ç»„å¯¹è±¡è½¬åŒ–ä¸ºçœŸæ­£çš„æ•°ç»„ï¼š<code>Array.from</code></strong></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-7/44455334.jpg" alt=""></p>
<p><strong>å°†ä¸€ç»„å€¼è½¬åŒ–ä¸ºæ•°ç»„ï¼šArray.of</strong></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-7/42839910.jpg" alt=""></p>
<p><strong>å°†å½“å‰æ•°ç»„å†…éƒ¨æŒ‡å®šä½ç½®çš„æˆå‘˜å¤åˆ¶åˆ°å…¶ä»–çš„ä½ç½®ï¼šcopyWithin</strong></p>
<p>å…·ä½“è¯­æ³•ä¸º<code>Array.prototype.copyWithin(target,start = 0, end = this.length)</code>,æ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œtarget(å¿…é€‰)ï¼Œä»å½“å‰ä½ç½®å¼€å§‹æ›¿æ¢æ•°æ®ï¼Œstart(å¯é€‰)ï¼Œä»è¯¥ä½ç½®å¼€å§‹è¯»å–æ•°æ®ï¼Œè´Ÿæ•°è¡¨ç¤ºå€’æ•°ï¼Œend(å¯é€‰)ï¼Œé»˜è®¤ä¸ºæ•°ç»„é•¿åº¦ï¼›</p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-7/3645079.jpg" alt=""></p>
<p><strong>å¯»æ‰¾æ•°ç»„ä¸­ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼šfindå’ŒfindIndex</strong></p>
<p><code>find</code>æ–¹æ³•ï¼Œæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ éƒ½ä¼šæ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œè‹¥æ‰¾åˆ°è¿”å›è¿™ä¸ªå…ƒç´ ï¼Œæ²¡æ‰¾åˆ°åˆ™è¿”å›<code>undefine</code></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-7/91334943.jpg" alt=""></p>
<p><code>findIndex</code>ï¼Œæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ éƒ½ä¼šæ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œæ‰¾åˆ°è¿”å›å…·ä½“çš„ç´¢å¼•ä½ç½®ï¼Œæ‰¾ä¸åˆ°è¿”å› -1</p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-7/86472470.jpg" alt=""></p>
<p><strong>å®šå€¼å¡«å……æ•°ç»„</strong></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-7/35563292.jpg" alt=""></p>
<p><strong>æ•°ç»„å®ä¾‹çš„entriesã€keysã€values</strong></p>
<p><code>keys</code></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-7/20213197.jpg" alt=""></p>
<p><code>values:æŠ¥é”™ï¼Œæš‚æ—¶ä¸æ¸…æ¥šä»€ä¹ˆåŸå› ï¼Ÿåç»­è§£å†³ğŸ¤”</code></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-7/67413393.jpg" alt=""></p>
<p><code>entries</code></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-7/89340245.jpg" alt=""></p>
<p><strong>æ•°ç»„å®ä¾‹includes</strong></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-7/36818030.jpg" alt=""></p>
<p><strong>æ•°ç»„ç©ºä½</strong><br><code>æ¯”å¦‚Arrayæ„é€ å‡½æ•°è¿”å›çš„æ•°ç»„éƒ½æ˜¯ç©ºä½ Array[3] // [,,,]</code>ï¼›ç©ºä½æ²¡æœ‰ä»»ä½•å€¼ï¼Œä¸€ä¸ªä½ç½®çš„å€¼ç­‰äºundefinedä»æ˜¯æœ‰å€¼å¾—ã€‚</p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-7/68402315.jpg" alt=""></p>
<p><strong>æ•°ç»„æ¨å¯¼</strong></p>
<p>æ•°ç»„æ¨å¯¼å…è®¸ç›´æ¥é€šè¿‡ç°æœ‰æ•°ç»„ç”Ÿæˆæ–°æ•°ç»„ã€‚</p>
<p><code>æ¡ˆä¾‹1ï¼šæš‚æ—¶ä¸æ¸…æ¥šå…¶ä¸ºä½•æŠ¥é”™ï¼Œåç»­è§£å†³ğŸ¤”</code><br><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-7/18821221.jpg" alt=""></p>
<h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><ul>
<li>ES6æ ‡å‡†å…¥é—¨ â€“ é˜®ä¸€å³°</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/06/ES6ä¹‹å­—ç¬¦ä¸²çš„æ‰©å±•/" itemprop="url">
                  ES6ä¹‹å­—ç¬¦ä¸²çš„æ‰©å±•
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">å‘è¡¨äº</span>
            <time itemprop="dateCreated" datetime="2016-09-06T23:19:06+08:00" content="2016-09-06">
              2016-09-06
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JavaScript/" itemprop="url" rel="index">
                    <span itemprop="name">JavaScript</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/06/ES6ä¹‹å­—ç¬¦ä¸²çš„æ‰©å±•/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/06/ES6ä¹‹å­—ç¬¦ä¸²çš„æ‰©å±•/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>ä¸Šä¸€ç¯‡æ–‡ç« å­¦ä¹ äº†<a href="http://jianwl.com/2016/09/03/ES6%E4%B9%8B%E8%A7%A3%E6%9E%84/#more">ES6ä¹‹è§£æ„</a>ï¼Œæœ¬æ–‡å°†å­¦ä¹ ES6ä¸­å­—ç¬¦ä¸²çš„æ‰©å±•ã€‚</p>
<h3 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h3><p><strong>å­—ç¬¦ä¸²éå†:ç”±forâ€¦ofå¾ªç¯éå†</strong></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-6/54541215.jpg" alt=""></p>
<p>é™¤äº†éå†ä»¥å¤–ï¼Œè¿™ä¸ªéå†å™¨æœ€å¥½çš„ä¼˜ç‚¹æ˜¯å¯ä»¥è¯†åˆ«å¤§äº<code>0xFFFF</code>çš„ç ç‚¹ï¼Œä¼ ç»Ÿçš„forå¾ªç¯æ— æ³•è¯†åˆ«è¿™æ ·çš„ç ç‚¹ã€‚</p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-6/2647027.jpg" alt=""></p>
<p><strong>æ–°å¢includes()ã€startWith()ã€endsWith()æ–¹æ³•</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">æ–¹æ³•</th>
<th style="text-align:center">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">includes()</td>
<td style="text-align:center">æ˜¯å¦æ‰¾åˆ°å‚æ•°å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td style="text-align:left">startsWith</td>
<td style="text-align:center">æ˜¯å¦ä»¥å‚æ•°å­—ç¬¦ä¸²å¼€å¤´</td>
</tr>
<tr>
<td style="text-align:left">endsWith</td>
<td style="text-align:center">æ˜¯å¦ä»¥å‚æ•°å­—ç¬¦ä¸²ç»“å°¾</td>
</tr>
</tbody>
</table>
<p><code>æ¡ˆä¾‹1</code></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-6/27503911.jpg" alt=""></p>
<p><strong>æ¨¡æ¿å­—ç¬¦ä¸²</strong></p>
<p>ä¼ ç»Ÿçš„JavaScriptè¾“å‡ºæ¨¡æ¿é€šå¸¸æ˜¯è¿™æ ·å†™çš„ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">var world = &quot;liuMing&quot;;</div><div class="line">$(&quot;#result&quot;).append(&quot;Hello: &quot; + world + &quot;!&quot;);</div></pre></td></tr></table></figure></p>
<p>ES6å¼•å…¥äº†æ¨¡æ¿å­—ç¬¦ä¸²æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç”¨åå¼•å· ` æ ‡è¯†ï¼Œå®ƒå¯ä»¥å½“åšæ™®é€šå­—ç¬¦ä¸²ã€ä¹Ÿå¯ä»¥å®šä¹‰å¤šè¡Œå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥åœ¨å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡ã€‚<br><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-6/47264420.jpg" alt=""></p>
<h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><ul>
<li>ES6æ ‡å‡†å…¥é—¨ â€“ é˜®ä¸€å³°</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/05/SpringBooté…ç½®å¤šä¸ªæ•°æ®æº/" itemprop="url">
                  SpringBooté…ç½®å¤šä¸ªæ•°æ®æº
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">å‘è¡¨äº</span>
            <time itemprop="dateCreated" datetime="2016-09-05T14:47:42+08:00" content="2016-09-05">
              2016-09-05
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/SpringBoot/" itemprop="url" rel="index">
                    <span itemprop="name">SpringBoot</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/05/SpringBooté…ç½®å¤šä¸ªæ•°æ®æº/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/05/SpringBooté…ç½®å¤šä¸ªæ•°æ®æº/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>ä¸Šç¯‡æ–‡ç« ä»‹ç»<a href="http://jianwl.com/2016/09/04/SpringBoot%E9%9B%86%E6%88%90JOOQ/">SpringBooté›†æˆJOOQ</a>ï¼Œæœ¬æ–‡æ˜¯å…¶ä¹‹ä¸Šçš„å»¶ä¼¸ï¼Œå°†ä»‹ç»åœ¨<code>SpringBoot</code>ä¸‹ï¼Œ<code>JOOQ</code>å¦‚ä½•é…ç½®å¤šä¸ªæ•°æ®æºã€‚</p>
<h3 id="ä¸ºä½•éœ€è¦é…ç½®å¤šä¸ªæ•°æ®åº“ï¼Ÿ"><a href="#ä¸ºä½•éœ€è¦é…ç½®å¤šä¸ªæ•°æ®åº“ï¼Ÿ" class="headerlink" title="ä¸ºä½•éœ€è¦é…ç½®å¤šä¸ªæ•°æ®åº“ï¼Ÿ"></a>ä¸ºä½•éœ€è¦é…ç½®å¤šä¸ªæ•°æ®åº“ï¼Ÿ</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>SpringBoot</code>ä½¿ç”¨çš„æ˜¯å•æ•°æ®åº“é…ç½®ï¼ˆé€šè¿‡spring.datasource.*é…ç½®å…·ä½“æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼‰ã€‚å¯¹äºç»å¤§å¤šæ•°<code>SpringBoot</code>åº”ç”¨ï¼Œè¿™æ˜¯ç¬¦åˆå…¶ä½¿ç”¨åœºæ™¯çš„ï¼Œå› ä¸º<code>Spring Boot</code>æå€¡çš„æ˜¯å¾®æœåŠ¡ç†å¿µï¼Œæ¯ä¸ªåº”ç”¨å¯¹åº”ä¸€ä¸ªå•ç‹¬çš„ä¸šåŠ¡é¢†åŸŸã€‚ä½†åœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œä¸€ä¸ªåº”ç”¨å¯¹åº”å¤šä¸ªæ•°æ®åº“åˆæ˜¯æ— æ³•é¿å…çš„ï¼Œä¾‹å¦‚å®æ–½æ•°æ®åº“åˆ†åº“ååŸæœ¬å•ä¸ªæ•°æ®åº“å˜ä¸ºå¤šä¸ªæ•°æ®åº“ã€‚æœ¬æ–‡å°±ç»“åˆå®é™…ä»£ç ä»‹ç»å¦‚ä½•åœ¨å•ä¸ª<code>Boot</code>åº”ç”¨ä¸­é…ç½®å¤šæ•°æ®åº“ï¼Œä»¥åŠä¸ä¹‹ç›¸å…³çš„<code>Druid</code>ï¼Œ<code>jOOQ</code>æ•°æ®æœåŠ¡æ¡†æ¶çš„é…ç½®æ”¹é€ ã€‚</p>
<h3 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h3><p><strong>æ•°æ®å¯¹è±¡</strong></p>
<p><code>TESTåº“Adminè¡¨</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">CREATE TABLE `admin` (</div><div class="line">  `id` int(11) NOT NULL AUTO_INCREMENT,</div><div class="line">  `username` varchar(20) DEFAULT &apos;&apos;,</div><div class="line">  `password` varchar(20) DEFAULT &apos;&apos;,</div><div class="line">  `nick_name` varchar(20) DEFAULT NULL,</div><div class="line">  `address` varchar(20) DEFAULT NULL,</div><div class="line">  `is_del` int(11) DEFAULT &apos;0&apos;,</div><div class="line">  `created_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP,</div><div class="line">  `updated_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,</div><div class="line">  PRIMARY KEY (`id`),</div><div class="line">  KEY `username` (`username`)</div><div class="line">) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8;</div></pre></td></tr></table></figure>
<p><code>DADAåº“Userè¡¨</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">CREATE TABLE `user` (</div><div class="line">  `id` int(11) NOT NULL AUTO_INCREMENT,</div><div class="line">  `username` varchar(11) NOT NULL DEFAULT &apos;&apos;,</div><div class="line">  `is_del` int(11) NOT NULL DEFAULT &apos;0&apos;,</div><div class="line">  `create_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,</div><div class="line">  `update_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,</div><div class="line">  PRIMARY KEY (`id`)</div><div class="line">) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8;</div></pre></td></tr></table></figure>
<p><strong>pom.xml</strong></p>
<p>å¯å‚è€ƒè¿™ç¯‡æ–‡ç« <a href="http://jianwl.com/2016/09/04/SpringBoot%E9%9B%86%E6%88%90JOOQ/">SpringBooté›†æˆJOOQ</a>çš„<code>pom.xml</code>,å¢åŠ å¦‚ä¸‹é…ç½®ï¼š<br><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-5/43787554.jpg" alt=""></p>
<p><strong>è‡ªåŠ¨ç”Ÿæˆä»£ç </strong></p>
<p>åœ¨æ§åˆ¶å°ï¼Œæ‰§è¡Œ<code>mvn clean compile</code>ï¼ŒJOOQä¼šè¯»å–ç›¸åº”æ•°æ®åº“çš„è¡¨ç”Ÿæˆå¯¹åº”çš„POJOã€‚</p>
<p><strong>Druidè¿æ¥æ± </strong></p>
<p>Druidæ˜¯é˜¿é‡Œå·´å·´å¼€æºçš„æ•°æ®åº“è¿æ¥æ± ï¼Œæä¾›äº†å¼ºå¤§çš„ç›‘æ§æ”¯æŒï¼Œå·ç§°Javaè¯­è¨€ä¸­æœ€å¥½çš„è¿æ¥æ± ã€‚åˆ›å»ºä¸¤ä¸ªé…ç½®ç±»åˆ†åˆ«æ³¨å†Œå¯¹åº”TESTåº“å’ŒDADAåº“ã€‚<em>ç‰¹åˆ«æ³¨æ„ï¼Œå£°æ˜å¤šä¸ªåº“æ—¶ï¼Œéœ€è¦å£°æ˜æŸä¸€ä¸ªåº“ä¸ºé»˜è®¤è£…é…å®ä¾‹ï¼Œç”¨æ³¨è§£@Primaryï¼Œå¦åˆ™å°†æŠ¥é”™ï¼Œä¸èƒ½åŒæ—¶æ³¨å†Œå¤šä¸ªå®ä¾‹ã€‚</em></p>
<p><code>TestDbConfig.class</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">@Configuration</div><div class="line">public class TestDbConfig &#123;</div><div class="line">    @Bean(initMethod = &quot;init&quot;, destroyMethod = &quot;close&quot;)</div><div class="line">    @ConfigurationProperties(prefix = &quot;db.test&quot;)</div><div class="line">    @Primary</div><div class="line">    public DataSource dataSourceA() &#123;</div><div class="line">        return new DruidDataSource();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Bean</div><div class="line">    @Primary</div><div class="line">    public DataSourceTransactionManager transactionManagerA() &#123;</div><div class="line">        DataSourceTransactionManager transactionManager = new DataSourceTransactionManager();</div><div class="line">        transactionManager.setDataSource(dataSourceA());</div><div class="line">        return transactionManager;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>DadaDbConfig.class</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">@Configuration</div><div class="line">public class DadaDbConfig &#123;</div><div class="line">    @Bean(initMethod = &quot;init&quot;, destroyMethod = &quot;close&quot;)</div><div class="line">    @ConfigurationProperties(prefix = &quot;db.dada&quot;)</div><div class="line">    public DataSource dataSourceB() &#123;</div><div class="line">        return new DruidDataSource();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Bean</div><div class="line">    public DataSourceTransactionManager transactionManagerB() &#123;</div><div class="line">        DataSourceTransactionManager transactionManager = new DataSourceTransactionManager();</div><div class="line">        transactionManager.setDataSource(dataSourceB());</div><div class="line">        return transactionManager;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>æ•°æ®åº“å‚æ•°é…ç½®ï¼šapplication.properties</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">db.test.url=jdbc:mysql://127.0.0.1:3306/test?useUnicode=true&amp;characterEncoding=UTF-8&amp;rewriteBatchedStatements=true</div><div class="line">db.test.username=root</div><div class="line">db.test.password=</div><div class="line">db.test.initialSize=1</div><div class="line">db.test.minIdle=1</div><div class="line">db.test.maxActive=100</div><div class="line">db.test.filters=stat</div><div class="line"></div><div class="line">db.dada.url=jdbc:mysql://127.0.0.1:3306/dada?useUnicode=true&amp;characterEncoding=UTF-8&amp;rewriteBatchedStatements=true</div><div class="line">db.dada.username=root</div><div class="line">db.dada.password=</div><div class="line">db.dada.initialSize=1</div><div class="line">db.dada.minIdle=1</div><div class="line">db.dada.maxActive=100</div><div class="line">db.dada.filters=stat</div></pre></td></tr></table></figure>
<p><strong>JOOQé…ç½®</strong></p>
<p>ç‰¹åˆ«æ³¨æ„ï¼Œéœ€è¦å£°æ˜æŸä¸€ä¸ªæ•°æ®åº“ä¸ºé»˜è®¤è£…è½½æ•°æ®åº“ï¼Œç”¨æ³¨è§£<code>@Primary</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div></pre></td><td class="code"><pre><div class="line">@Configuration</div><div class="line">public class JooqConfig &#123;</div><div class="line">    @Bean</div><div class="line">    public DataSourceConnectionProvider dataSourceConnectionProviderA(</div><div class="line">            @Qualifier(&quot;dataSourceA&quot;) DataSource dataSourceA) &#123;</div><div class="line">        return new DataSourceConnectionProvider(</div><div class="line">                new TransactionAwareDataSourceProxy(dataSourceA));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Bean</div><div class="line">    public SpringTransactionProvider transactionProviderA(</div><div class="line">            @Qualifier(&quot;transactionManagerA&quot;) DataSourceTransactionManager txManagerW) &#123;</div><div class="line">        return new SpringTransactionProvider(txManagerW);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Bean</div><div class="line">    public DataSourceConnectionProvider dataSourceConnectionProviderB(</div><div class="line">            @Qualifier(&quot;dataSourceB&quot;) DataSource dataSourceB) &#123;</div><div class="line">        return new DataSourceConnectionProvider(</div><div class="line">                new TransactionAwareDataSourceProxy(dataSourceB));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Bean</div><div class="line">    public SpringTransactionProvider transactionProviderB(</div><div class="line">            @Qualifier(&quot;transactionManagerB&quot;) DataSourceTransactionManager txManagerB) &#123;</div><div class="line">        return new SpringTransactionProvider(txManagerB);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Configuration</div><div class="line">    public static class DslContextConfig &#123;</div><div class="line"></div><div class="line">        @Autowired(required = false)</div><div class="line">        private RecordMapperProvider recordMapperProvider;</div><div class="line"></div><div class="line">        @Autowired(required = false)</div><div class="line">        private Settings settings;</div><div class="line"></div><div class="line">        @Autowired(required = false)</div><div class="line">        private RecordListenerProvider[] recordListenerProviders;</div><div class="line"></div><div class="line">        @Autowired</div><div class="line">        private ExecuteListenerProvider[] executeListenerProviders;</div><div class="line"></div><div class="line">        @Autowired(required = false)</div><div class="line">        private VisitListenerProvider[] visitListenerProviders;</div><div class="line"></div><div class="line">        @Bean</div><div class="line">        @Primary</div><div class="line">        public DefaultDSLContext dslContextA(@Qualifier(value = &quot;dataSourceConnectionProviderA&quot;) DataSourceConnectionProvider connectionProviderA,</div><div class="line">                                             @Qualifier(&quot;transactionProviderA&quot;) SpringTransactionProvider transactionProviderA) &#123;</div><div class="line">            return new DefaultDSLContext(configuration(connectionProviderA, transactionProviderA));</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        @Bean</div><div class="line">        public DefaultDSLContext dslContextB(@Qualifier(value = &quot;dataSourceConnectionProviderB&quot;) DataSourceConnectionProvider connectionProviderB,</div><div class="line">                                             @Qualifier(&quot;transactionProviderB&quot;) SpringTransactionProvider transactionProviderB) &#123;</div><div class="line">            return new DefaultDSLContext(configuration(connectionProviderB, transactionProviderB));</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        private DefaultConfiguration configuration(ConnectionProvider connectionProvider, TransactionProvider transactionProvider) &#123;</div><div class="line">            DefaultConfiguration configuration = new DefaultConfiguration();</div><div class="line">            configuration.setSQLDialect(SQLDialect.MYSQL);</div><div class="line">            configuration.set(connectionProvider);</div><div class="line">            configuration.set(transactionProvider);</div><div class="line">            if (this.recordMapperProvider != null) &#123;</div><div class="line">                configuration.set(this.recordMapperProvider);</div><div class="line">            &#125;</div><div class="line">            if (this.settings != null) &#123;</div><div class="line">                configuration.set(this.settings);</div><div class="line">            &#125;</div><div class="line">            configuration.set(this.recordListenerProviders);</div><div class="line">            configuration.set(this.executeListenerProviders);</div><div class="line">            configuration.set(this.visitListenerProviders);</div><div class="line">            return configuration;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>äº‹åŠ¡é…ç½®</strong></p>
<p><code>SpringTransaction.class</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">public class SpringTransaction implements Transaction &#123;</div><div class="line"></div><div class="line">    // Based on the jOOQ-spring-example from https://github.com/jOOQ/jOOQ</div><div class="line"></div><div class="line">    private final TransactionStatus transactionStatus;</div><div class="line"></div><div class="line">    SpringTransaction(TransactionStatus transactionStatus) &#123;</div><div class="line">        this.transactionStatus = transactionStatus;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public TransactionStatus getTxStatus() &#123;</div><div class="line">        return this.transactionStatus;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>SpringTransactionProvider.class</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">public class SpringTransactionProvider implements TransactionProvider &#123;</div><div class="line"></div><div class="line">    // Based on the jOOQ-spring-example from https://github.com/jOOQ/jOOQ</div><div class="line"></div><div class="line">    private final PlatformTransactionManager transactionManager;</div><div class="line"></div><div class="line">    public SpringTransactionProvider(PlatformTransactionManager transactionManager) &#123;</div><div class="line">        this.transactionManager = transactionManager;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public void begin(TransactionContext context) &#123;</div><div class="line">        TransactionDefinition definition = new DefaultTransactionDefinition(</div><div class="line">                TransactionDefinition.PROPAGATION_NESTED);</div><div class="line">        TransactionStatus status = this.transactionManager.getTransaction(definition);</div><div class="line">        context.transaction(new SpringTransaction(status));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public void commit(TransactionContext ctx) &#123;</div><div class="line">        this.transactionManager.commit(getTransactionStatus(ctx));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public void rollback(TransactionContext ctx) &#123;</div><div class="line">        this.transactionManager.rollback(getTransactionStatus(ctx));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private TransactionStatus getTransactionStatus(TransactionContext ctx) &#123;</div><div class="line">        SpringTransaction transaction = (SpringTransaction) ctx.transaction();</div><div class="line">        return transaction.getTxStatus();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è‡³æ­¤å®Œæˆäº†ï¼Œåœ¨SpringBootä¸‹JOOQé…ç½®å¤šä¸ªæ•°æ®æºã€‚</p>
<h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><ul>
<li><a href="http://emacoo.cn/blog/spring-boot-multi-db" target="_blank" rel="external">ã€Springã€‘å¦‚ä½•åœ¨å•ä¸ªBootåº”ç”¨ä¸­é…ç½®å¤šæ•°æ®åº“ï¼Ÿ</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/04/Shellå…¥é—¨/" itemprop="url">
                  Shellå…¥é—¨
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">å‘è¡¨äº</span>
            <time itemprop="dateCreated" datetime="2016-09-04T23:00:05+08:00" content="2016-09-04">
              2016-09-04
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Shell/" itemprop="url" rel="index">
                    <span itemprop="name">Shell</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/04/Shellå…¥é—¨/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/04/Shellå…¥é—¨/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>ç§»åŠ¨äº’è”ç½‘åº”ç”¨çš„æµè¡Œä½¿å¾—æ¯å‘¨éƒ½æœ‰æˆç™¾ä¸Šåƒçš„åº”ç”¨éƒ¨ç½²åœ¨äº‘å¹³å°ä¸Šï¼Œè€ŒèƒŒåæ”¯æ’‘è¿™äº›äº‘çš„æ­£æ˜¯<code>Linux</code>.<code>Linux</code>æœåŠ¡å™¨ä¸Šå¤§é‡çš„æ•°æ®å¤„ç†å’Œç®¡ç†å·¥ä½œéœ€è¦ä½¿ç”¨å‘½ä»¤è¡Œå’Œ<code>Shell</code>è„šæœ¬ã€‚</p>
<h3 id="å‘½ä»¤å®æˆ˜"><a href="#å‘½ä»¤å®æˆ˜" class="headerlink" title="å‘½ä»¤å®æˆ˜"></a>å‘½ä»¤å®æˆ˜</h3><p><strong>æ–‡ä»¶æƒé™ç¬¦</strong><br><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-4/30894252.jpg" alt=""></p>
<p>ä¸Šè¿°çº¢è‰²æ¡†åœˆå‡ºçš„éƒ¨åˆ†æ˜¯æè¿°æ–‡ä»¶å’Œç›®å½•æƒé™ç ï¼Œå…·ä½“å«ä¹‰å¦‚ä¸‹ï¼ˆä»å·¦åˆ°å³ï¼‰ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">// ç¬¬ä¸€ä¸ªå­—ç¬¦ä»£è¡¨å¯¹è±¡ç±»å‹</div><div class="line">- ä»£è¡¨æ–‡ä»¶</div><div class="line">d ä»£è¡¨ç›®å½•</div><div class="line">l ä»£è¡¨é“¾æ¥</div><div class="line">c ä»£è¡¨å­—ç¬¦å‹è®¾å¤‡</div><div class="line">b ä»£è¡¨å—è®¾å¤‡</div><div class="line">n ä»£è¡¨ç½‘ç»œè®¾å¤‡</div><div class="line"></div><div class="line">//ä¹‹åæœ‰3ç»„ä¸‰ä¸ªå­—ç¬¦çš„ç </div><div class="line">r ä»£è¡¨å¯¹è±¡æ˜¯å¯è¯»çš„</div><div class="line">w ä»£è¡¨å¯¹è±¡æ˜¯å¯å†™çš„</div><div class="line">x ä»£è¡¨å¯¹è±¡æ˜¯å¯æ‰§è¡Œçš„</div><div class="line"></div><div class="line">// 3ç»„ä¸‰å­—ç å¯¹åº”å¯¹è±¡çš„ä¸‰ä¸ªå®‰å…¨çº§åˆ«</div><div class="line">å¯¹è±¡çš„å±ä¸»</div><div class="line">å¯¹è±¡çš„å±ç»„</div><div class="line">ç³»ç»Ÿå…¶ä»–ç”¨æˆ·</div></pre></td></tr></table></figure>
<p><code>æ¡ˆä¾‹1ï¼šä¿®æ”¹æ‰€å±ä¸»æƒé™</code><br><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-4/88563757.jpg" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">u ä»£è¡¨ç”¨æˆ·</div><div class="line">g ä»£è¡¨ç»„</div><div class="line">o ä»£è¡¨å…¶ä»–</div><div class="line">a ä»£è¡¨ä¸Šè¿°æ‰€æœ‰</div></pre></td></tr></table></figure>
<p><code>å°†è¯¥æ–‡ä»¶çš„ä¸‰ä¸ªå®‰å…¨çº§åˆ«å‡è®¾ä¸ºå¯è¯»ã€å†™ã€æ‰§è¡Œ</code><br><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-4/47093815.jpg" alt=""></p>
<p><code>æ¡ˆä¾‹2ï¼šæ”¹å˜æ‰€å±å…³ç³»</code><br><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-4/99885145.jpg" alt=""><br>æ”¹å˜æ‰€å±å…³ç³»ç”¨chownå‘½ä»¤ï¼Œè¯­æ³•ä¸º<code>chown owner:group file</code></p>
<p><code>æŸ¥è¯¢æ‰€æœ‰ç»„</code><br><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-4/8200700.jpg" alt=""></p>
<p>æœªå®Œå¾…ç»­â€¦</p>
<h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><ul>
<li>Linuxå‘½ä»¤è¡Œä¸Shellè„šæœ¬ç¼–ç¨‹å¤§å…¨ï¼ˆç¬¬2ç‰ˆï¼‰</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/04/SpringBooté›†æˆJOOQ/" itemprop="url">
                  SpringBooté›†æˆJOOQ
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">å‘è¡¨äº</span>
            <time itemprop="dateCreated" datetime="2016-09-04T21:04:44+08:00" content="2016-09-04">
              2016-09-04
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/SpringBoot/" itemprop="url" rel="index">
                    <span itemprop="name">SpringBoot</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/04/SpringBooté›†æˆJOOQ/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/04/SpringBooté›†æˆJOOQ/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>ä¹‹å‰å†™è¿‡<a href="http://jianwl.com/2016/06/14/JOOQ%E5%85%A5%E9%97%A8%E7%AF%87/">JOOQå…¥é—¨ç¯‡</a>å’Œ<a href="http://jianwl.com/2016/06/18/SpringBoot%E5%85%A5%E9%97%A8%E7%AF%87/">SpringBootå…¥é—¨ç¯‡</a>è¿™ä¸¤ç¯‡æ–‡ç« ï¼Œå¦‚æœä¸äº†è§£JOOQå’ŒSpringBootå¯ä»¥å…ˆçœ‹çœ‹ä¹‹å‰çš„æ–‡ç« ã€‚æœ€è¿‘æ–°å…¥èŒï¼Œå‘ç°å…¬å¸ç°æœ‰çš„é¡¹ç›®æ˜¯åŸºäº<code>SpringMVCå’ŒMyBatis</code>ï¼ŒSpringMVCéœ€è¦è®¾ç½®å„ç§é…ç½®æ–‡ä»¶ï¼ŒMybatiséœ€è¦ç”Ÿæˆå„æœ‰<code>Mapper.xml</code>æ„Ÿè§‰æŒºç¹ççš„ï¼Œæ‰€ä»¥æƒ³å°è¯•å¼•å…¥<code>SpringBootå’ŒJOOQ</code>æ¡†æ¶ã€‚æœ¬æ–‡ä¸»è¦ä»‹ç»SpringBootå¦‚ä½•é›†æˆJOOQã€‚</p>
<h3 id="SpringBooté›†æˆJOOQå®æˆ˜"><a href="#SpringBooté›†æˆJOOQå®æˆ˜" class="headerlink" title="SpringBooté›†æˆJOOQå®æˆ˜"></a>SpringBooté›†æˆJOOQå®æˆ˜</h3><p><strong>æ•°æ®è¡¨</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">CREATE TABLE `admin` (</div><div class="line">  `id` int(11) NOT NULL AUTO_INCREMENT,</div><div class="line">  `username` varchar(20) DEFAULT &apos;&apos;,</div><div class="line">  `password` varchar(20) DEFAULT &apos;&apos;,</div><div class="line">  `nick_name` varchar(20) DEFAULT NULL,</div><div class="line">  `address` varchar(20) DEFAULT NULL,</div><div class="line">  `is_del` int(11) DEFAULT &apos;0&apos;,</div><div class="line">  `created_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP,</div><div class="line">  `updated_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,</div><div class="line">  PRIMARY KEY (`id`),</div><div class="line">  KEY `username` (`username`)</div><div class="line">) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8;</div></pre></td></tr></table></figure>
<p><strong>åˆ›å»ºSpringBootJOOQé¡¹ç›®</strong></p>
<p>æ–°å»ºé¡¹ç›®é€‰æ‹©<code>spring Initializr</code><br><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-4/15159353.jpg" alt=""></p>
<p>å‹¾é€‰<code>JOOQ</code>ï¼Œç‚¹å‡»<code>Next</code><br><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-4/93706206.jpg" alt=""></p>
<p><strong>pom.xml</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</div><div class="line">&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</div><div class="line">         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;</div><div class="line">    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;</div><div class="line"></div><div class="line">    &lt;groupId&gt;com.dada&lt;/groupId&gt;</div><div class="line">    &lt;artifactId&gt;springjooqdemo&lt;/artifactId&gt;</div><div class="line">    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;</div><div class="line">    &lt;packaging&gt;jar&lt;/packaging&gt;</div><div class="line"></div><div class="line">    &lt;name&gt;SpringJOOQDemo&lt;/name&gt;</div><div class="line">    &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;</div><div class="line"></div><div class="line">    &lt;parent&gt;</div><div class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</div><div class="line">        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</div><div class="line">        &lt;version&gt;1.4.0.RELEASE&lt;/version&gt;</div><div class="line">        &lt;relativePath/&gt;</div><div class="line">    &lt;/parent&gt;</div><div class="line"></div><div class="line">    &lt;properties&gt;</div><div class="line">        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;</div><div class="line">        &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;</div><div class="line">        &lt;java.version&gt;1.8&lt;/java.version&gt;</div><div class="line">    &lt;/properties&gt;</div><div class="line"></div><div class="line">    &lt;dependencies&gt;</div><div class="line">        &lt;!--lombok--&gt;</div><div class="line">        &lt;dependency&gt;</div><div class="line">            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;</div><div class="line">            &lt;artifactId&gt;lombok&lt;/artifactId&gt;</div><div class="line">            &lt;version&gt;1.16.10&lt;/version&gt;</div><div class="line">        &lt;/dependency&gt;</div><div class="line"></div><div class="line">        &lt;!--è¿æ¥æ± --&gt;</div><div class="line">        &lt;dependency&gt;</div><div class="line">            &lt;groupId&gt;com.alibaba&lt;/groupId&gt;</div><div class="line">            &lt;artifactId&gt;druid&lt;/artifactId&gt;</div><div class="line">            &lt;version&gt;1.0.24&lt;/version&gt;</div><div class="line">        &lt;/dependency&gt;</div><div class="line"></div><div class="line">        &lt;!--mysql connector java--&gt;</div><div class="line">        &lt;dependency&gt;</div><div class="line">            &lt;groupId&gt;mysql&lt;/groupId&gt;</div><div class="line">            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</div><div class="line">            &lt;version&gt;5.1.39&lt;/version&gt;</div><div class="line">        &lt;/dependency&gt;</div><div class="line"></div><div class="line">        &lt;!--springboot start--&gt;</div><div class="line">        &lt;dependency&gt;</div><div class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</div><div class="line">            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</div><div class="line">        &lt;/dependency&gt;</div><div class="line"></div><div class="line">        &lt;dependency&gt;</div><div class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</div><div class="line">            &lt;artifactId&gt;spring-boot-starter-jooq&lt;/artifactId&gt;</div><div class="line">        &lt;/dependency&gt;</div><div class="line"></div><div class="line">        &lt;dependency&gt;</div><div class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</div><div class="line">            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;</div><div class="line">            &lt;scope&gt;test&lt;/scope&gt;</div><div class="line">        &lt;/dependency&gt;</div><div class="line">        &lt;!--springboot end--&gt;</div><div class="line"></div><div class="line">        &lt;!-- utils start--&gt;</div><div class="line">        &lt;dependency&gt;</div><div class="line">            &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;</div><div class="line">            &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt;</div><div class="line">            &lt;version&gt;3.4&lt;/version&gt;</div><div class="line">        &lt;/dependency&gt;</div><div class="line"></div><div class="line">        &lt;dependency&gt;</div><div class="line">            &lt;groupId&gt;commons-collections&lt;/groupId&gt;</div><div class="line">            &lt;artifactId&gt;commons-collections&lt;/artifactId&gt;</div><div class="line">            &lt;version&gt;3.2.2&lt;/version&gt;</div><div class="line">        &lt;/dependency&gt;</div><div class="line"></div><div class="line">        &lt;dependency&gt;</div><div class="line">            &lt;groupId&gt;com.google.guava&lt;/groupId&gt;</div><div class="line">            &lt;artifactId&gt;guava&lt;/artifactId&gt;</div><div class="line">            &lt;version&gt;19.0&lt;/version&gt;</div><div class="line">        &lt;/dependency&gt;</div><div class="line"></div><div class="line">        &lt;dependency&gt;</div><div class="line">            &lt;groupId&gt;com.alibaba&lt;/groupId&gt;</div><div class="line">            &lt;artifactId&gt;fastjson&lt;/artifactId&gt;</div><div class="line">            &lt;version&gt;1.2.16&lt;/version&gt;</div><div class="line">        &lt;/dependency&gt;</div><div class="line">        &lt;!-- utils end--&gt;</div><div class="line">    &lt;/dependencies&gt;</div><div class="line"></div><div class="line"></div><div class="line">    &lt;build&gt;</div><div class="line">        &lt;plugins&gt;</div><div class="line">            &lt;plugin&gt;</div><div class="line">                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;</div><div class="line">                &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;</div><div class="line">                &lt;configuration&gt;</div><div class="line">                    &lt;skip&gt;true&lt;/skip&gt;</div><div class="line">                &lt;/configuration&gt;</div><div class="line">            &lt;/plugin&gt;</div><div class="line">            &lt;plugin&gt;</div><div class="line">                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</div><div class="line">                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</div><div class="line">            &lt;/plugin&gt;</div><div class="line">            &lt;plugin&gt;</div><div class="line">                &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;</div><div class="line">                &lt;artifactId&gt;build-helper-maven-plugin&lt;/artifactId&gt;</div><div class="line">                &lt;executions&gt;</div><div class="line">                    &lt;execution&gt;</div><div class="line">                        &lt;phase&gt;generate-sources&lt;/phase&gt;</div><div class="line">                        &lt;goals&gt;</div><div class="line">                            &lt;goal&gt;add-source&lt;/goal&gt;</div><div class="line">                        &lt;/goals&gt;</div><div class="line">                        &lt;configuration&gt;</div><div class="line">                            &lt;sources&gt;</div><div class="line">                                &lt;source&gt;gensrc/main/java&lt;/source&gt;</div><div class="line">                            &lt;/sources&gt;</div><div class="line">                        &lt;/configuration&gt;</div><div class="line">                    &lt;/execution&gt;</div><div class="line">                &lt;/executions&gt;</div><div class="line">            &lt;/plugin&gt;</div><div class="line">        &lt;/plugins&gt;</div><div class="line">        &lt;pluginManagement&gt;</div><div class="line">            &lt;plugins&gt;</div><div class="line">                &lt;plugin&gt;</div><div class="line">                    &lt;groupId&gt;org.jooq&lt;/groupId&gt;</div><div class="line">                    &lt;artifactId&gt;jooq-codegen-maven&lt;/artifactId&gt;</div><div class="line">                    &lt;version&gt;$&#123;jooq.version&#125;&lt;/version&gt;</div><div class="line">                    &lt;executions&gt;</div><div class="line">                        &lt;execution&gt;</div><div class="line">                            &lt;goals&gt;</div><div class="line">                                &lt;goal&gt;generate&lt;/goal&gt;</div><div class="line">                            &lt;/goals&gt;</div><div class="line">                        &lt;/execution&gt;</div><div class="line">                    &lt;/executions&gt;</div><div class="line">                    &lt;dependencies&gt;</div><div class="line">                        &lt;dependency&gt;</div><div class="line">                            &lt;groupId&gt;mysql&lt;/groupId&gt;</div><div class="line">                            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</div><div class="line">                            &lt;version&gt;$&#123;mysql.version&#125;&lt;/version&gt;</div><div class="line">                        &lt;/dependency&gt;</div><div class="line">                    &lt;/dependencies&gt;</div><div class="line">                    &lt;configuration&gt;</div><div class="line">                        &lt;generator&gt;</div><div class="line">                            &lt;generate&gt;</div><div class="line">                                &lt;pojos&gt;true&lt;/pojos&gt;</div><div class="line">                                &lt;fluentSetters&gt;true&lt;/fluentSetters&gt;</div><div class="line">                            &lt;/generate&gt;</div><div class="line">                        &lt;/generator&gt;</div><div class="line">                    &lt;/configuration&gt;</div><div class="line">                &lt;/plugin&gt;</div><div class="line">            &lt;/plugins&gt;</div><div class="line">        &lt;/pluginManagement&gt;</div><div class="line">    &lt;/build&gt;</div><div class="line"></div><div class="line">    &lt;profiles&gt;</div><div class="line">    &lt;profile&gt;</div><div class="line">        &lt;id&gt;gensrc-clinic&lt;/id&gt;</div><div class="line">        &lt;activation&gt;</div><div class="line">            &lt;activeByDefault&gt;true&lt;/activeByDefault&gt;</div><div class="line">        &lt;/activation&gt;</div><div class="line">        &lt;build&gt;</div><div class="line">            &lt;plugins&gt;</div><div class="line">                &lt;plugin&gt;</div><div class="line">                    &lt;groupId&gt;org.jooq&lt;/groupId&gt;</div><div class="line">                    &lt;artifactId&gt;jooq-codegen-maven&lt;/artifactId&gt;</div><div class="line">                    &lt;configuration&gt;</div><div class="line">                        &lt;jdbc&gt;</div><div class="line">                            &lt;driver&gt;com.mysql.jdbc.Driver&lt;/driver&gt;</div><div class="line">                            &lt;url&gt;jdbc:mysql://127.0.0.1:3306/test&lt;/url&gt;</div><div class="line">                            &lt;user&gt;root&lt;/user&gt;</div><div class="line">                            &lt;password&gt;&lt;/password&gt;</div><div class="line">                        &lt;/jdbc&gt;</div><div class="line">                        &lt;generator&gt;</div><div class="line">                            &lt;database&gt;</div><div class="line">                                &lt;name&gt;org.jooq.util.mysql.MySQLDatabase&lt;/name&gt;</div><div class="line">                                &lt;includes&gt;.*&lt;/includes&gt;</div><div class="line">                                &lt;excludes&gt;</div><div class="line">                                    schema_version</div><div class="line">                                &lt;/excludes&gt;</div><div class="line">                                &lt;inputSchema&gt;test&lt;/inputSchema&gt;</div><div class="line">                            &lt;/database&gt;</div><div class="line">                            &lt;target&gt;</div><div class="line">                                &lt;packageName&gt;com.dada.test.domain&lt;/packageName&gt;</div><div class="line">                                &lt;directory&gt;$&#123;basedir&#125;/gensrc/main/java&lt;/directory&gt;</div><div class="line">                            &lt;/target&gt;</div><div class="line">                        &lt;/generator&gt;</div><div class="line">                    &lt;/configuration&gt;</div><div class="line">                &lt;/plugin&gt;</div><div class="line">            &lt;/plugins&gt;</div><div class="line">        &lt;/build&gt;</div><div class="line">    &lt;/profile&gt;</div><div class="line">    &lt;/profiles&gt;</div><div class="line">&lt;/project&gt;</div></pre></td></tr></table></figure>
<p><strong>è‡ªåŠ¨ç”Ÿæˆä»£ç </strong></p>
<p>åœ¨æ§åˆ¶å°ä¸­æ‰§è¡Œ<code>mvn clean compile</code>ï¼Œjooqä¼šè¯»å–ç›¸åº”æ•°æ®åº“çš„è¡¨ç”Ÿæˆå¯¹åº”çš„POJOã€‚æ‰§è¡Œä¹‹åï¼Œå°†ç”Ÿæˆä»¥ä¸‹ä»£ç <br><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-4/11303630.jpg" alt=""><br>å…·ä½“è¿æ¥çš„æ•°æ®åº“æ˜¯åœ¨<code>pom.xml</code>è®¾ç½®çš„ï¼š<br><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-4/46566376.jpg" alt=""></p>
<p><strong>JOOQé…ç½®</strong></p>
<p><code>JooqConfig.class</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div></pre></td><td class="code"><pre><div class="line">package com.dada.config;</div><div class="line"></div><div class="line">import org.jooq.*;</div><div class="line">import org.jooq.conf.Settings;</div><div class="line">import org.jooq.impl.DataSourceConnectionProvider;</div><div class="line">import org.jooq.impl.DefaultConfiguration;</div><div class="line">import org.jooq.impl.DefaultDSLContext;</div><div class="line">import org.springframework.beans.factory.annotation.Autowired;</div><div class="line">import org.springframework.beans.factory.annotation.Qualifier;</div><div class="line">import org.springframework.context.annotation.Bean;</div><div class="line">import org.springframework.context.annotation.Configuration;</div><div class="line">import org.springframework.context.annotation.Primary;</div><div class="line">import org.springframework.jdbc.datasource.DataSourceTransactionManager;</div><div class="line">import org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy;</div><div class="line"></div><div class="line">import javax.sql.DataSource;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by jianweilin on 16/9/2.</div><div class="line"> */</div><div class="line">@Configuration</div><div class="line">public class JooqConfig &#123;</div><div class="line">    @Bean</div><div class="line">    public DataSourceConnectionProvider dataSourceConnectionProviderA(</div><div class="line">            @Qualifier(&quot;dataSourceA&quot;) DataSource dataSourceA) &#123;</div><div class="line">        return new DataSourceConnectionProvider(</div><div class="line">                new TransactionAwareDataSourceProxy(dataSourceA));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Bean</div><div class="line">    public SpringTransactionProvider transactionProviderA(</div><div class="line">            @Qualifier(&quot;transactionManagerA&quot;) DataSourceTransactionManager txManagerW) &#123;</div><div class="line">        return new SpringTransactionProvider(txManagerW);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Configuration</div><div class="line">    public static class DslContextConfig &#123;</div><div class="line"></div><div class="line">        @Autowired(required = false)</div><div class="line">        private RecordMapperProvider recordMapperProvider;</div><div class="line"></div><div class="line">        @Autowired(required = false)</div><div class="line">        private Settings settings;</div><div class="line"></div><div class="line">        @Autowired(required = false)</div><div class="line">        private RecordListenerProvider[] recordListenerProviders;</div><div class="line"></div><div class="line">        @Autowired</div><div class="line">        private ExecuteListenerProvider[] executeListenerProviders;</div><div class="line"></div><div class="line">        @Autowired(required = false)</div><div class="line">        private VisitListenerProvider[] visitListenerProviders;</div><div class="line"></div><div class="line">        @Bean</div><div class="line">        @Primary</div><div class="line">        public DefaultDSLContext dslContextA(@Qualifier(value = &quot;dataSourceConnectionProviderA&quot;) DataSourceConnectionProvider connectionProviderA,</div><div class="line">                                             @Qualifier(&quot;transactionProviderA&quot;) SpringTransactionProvider transactionProviderA) &#123;</div><div class="line">            return new DefaultDSLContext(configuration(connectionProviderA, transactionProviderA));</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        private DefaultConfiguration configuration(ConnectionProvider connectionProvider, TransactionProvider transactionProvider) &#123;</div><div class="line">            DefaultConfiguration configuration = new DefaultConfiguration();</div><div class="line">            configuration.setSQLDialect(SQLDialect.MYSQL);</div><div class="line">            configuration.set(connectionProvider);</div><div class="line">            configuration.set(transactionProvider);</div><div class="line">            if (this.recordMapperProvider != null) &#123;</div><div class="line">                configuration.set(this.recordMapperProvider);</div><div class="line">            &#125;</div><div class="line">            if (this.settings != null) &#123;</div><div class="line">                configuration.set(this.settings);</div><div class="line">            &#125;</div><div class="line">            configuration.set(this.recordListenerProviders);</div><div class="line">            configuration.set(this.executeListenerProviders);</div><div class="line">            configuration.set(this.visitListenerProviders);</div><div class="line">            return configuration;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>äº‹åŠ¡é…ç½®ï¼šSpringTransaction.class</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">public class SpringTransaction implements Transaction &#123;</div><div class="line"></div><div class="line">    // Based on the jOOQ-spring-example from https://github.com/jOOQ/jOOQ</div><div class="line"></div><div class="line">    private final TransactionStatus transactionStatus;</div><div class="line"></div><div class="line">    SpringTransaction(TransactionStatus transactionStatus) &#123;</div><div class="line">        this.transactionStatus = transactionStatus;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public TransactionStatus getTxStatus() &#123;</div><div class="line">        return this.transactionStatus;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>äº‹åŠ¡é…ç½®ï¼šSpringTransactionProvider.class</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">public class SpringTransactionProvider implements TransactionProvider &#123;</div><div class="line"></div><div class="line">    // Based on the jOOQ-spring-example from https://github.com/jOOQ/jOOQ</div><div class="line"></div><div class="line">    private final PlatformTransactionManager transactionManager;</div><div class="line"></div><div class="line">    public SpringTransactionProvider(PlatformTransactionManager transactionManager) &#123;</div><div class="line">        this.transactionManager = transactionManager;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public void begin(TransactionContext context) &#123;</div><div class="line">        TransactionDefinition definition = new DefaultTransactionDefinition(</div><div class="line">                TransactionDefinition.PROPAGATION_NESTED);</div><div class="line">        TransactionStatus status = this.transactionManager.getTransaction(definition);</div><div class="line">        context.transaction(new SpringTransaction(status));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public void commit(TransactionContext ctx) &#123;</div><div class="line">        this.transactionManager.commit(getTransactionStatus(ctx));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public void rollback(TransactionContext ctx) &#123;</div><div class="line">        this.transactionManager.rollback(getTransactionStatus(ctx));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private TransactionStatus getTransactionStatus(TransactionContext ctx) &#123;</div><div class="line">        SpringTransaction transaction = (SpringTransaction) ctx.transaction();</div><div class="line">        return transaction.getTxStatus();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>æ•°æ®åº“é…ç½®ï¼šTestDbConfig</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">@Configuration</div><div class="line">public class TestDbConfig &#123;</div><div class="line"></div><div class="line">    @Bean(initMethod = &quot;init&quot;, destroyMethod = &quot;close&quot;)</div><div class="line">    @ConfigurationProperties(prefix = &quot;db.test&quot;)</div><div class="line">    public DataSource dataSourceA() &#123;</div><div class="line">        return new DruidDataSource();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Bean</div><div class="line">    public DataSourceTransactionManager transactionManagerA() &#123;</div><div class="line">        DataSourceTransactionManager transactionManager = new DataSourceTransactionManager();</div><div class="line">        transactionManager.setDataSource(dataSourceA());</div><div class="line">        return transactionManager;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>é…ç½®æ•°æ®åº“å‚æ•°ï¼šapplication.properties</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">db.test.url=jdbc:mysql://127.0.0.1:3306/test?useUnicode=true&amp;characterEncoding=UTF-8&amp;rewriteBatchedStatements=true</div><div class="line">db.test.username=root</div><div class="line">db.test.password=</div><div class="line">db.test.initialSize=1</div><div class="line">db.test.minIdle=1</div><div class="line">db.test.maxActive=100</div><div class="line">db.test.filters=stat</div></pre></td></tr></table></figure>
<p><strong>å°è£…åŸºç¡€é€šç”¨DAOåº“</strong></p>
<p><code>DbConstants.class</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">public interface DbConstants &#123;</div><div class="line">	String DSL_TEST = &quot;dslContextA&quot;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>TableConstants.class</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">public interface TableConstants &#123;</div><div class="line">    Admin ADMIN = Tables.ADMIN;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>AbstractRepository.class</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">public abstract class AbstractRepository implements TableConstants ,DbConstants&#123;</div><div class="line">    @Autowired</div><div class="line">    @Qualifier(DSL_TEST)</div><div class="line">    protected DSLContext dsl;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>AbstractSingleReporitory.class</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div></pre></td><td class="code"><pre><div class="line">@SuppressWarnings(&quot;unused&quot;)</div><div class="line">public abstract class AbstractSingleRepository&lt;E extends Serializable&gt; extends AbstractRepository &#123;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * OR-Mappingçš„åŸºç¡€æ˜ å°„</div><div class="line">     *</div><div class="line">     * @return (Object, Relationship)</div><div class="line">     */</div><div class="line">    protected abstract Pair&lt;Class&lt;E&gt;, Table&lt;? extends UpdatableRecord&gt;&gt; mapping();</div><div class="line"></div><div class="line">    protected Class&lt;E&gt; type() &#123;</div><div class="line">        return mapping().getLeft();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    protected Table&lt;? extends UpdatableRecord&gt; table() &#123;</div><div class="line">        return mapping().getRight();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /*------------------------------------æŸ¥------------------------------------*/</div><div class="line">    public List&lt;E&gt; findAll() &#123;</div><div class="line">        return dsl.selectFrom(table()).fetchInto(type());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public Optional&lt;E&gt; findOptionalById(Integer id) &#123;</div><div class="line">        return findOptional(_pk(), id);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public &lt;Z&gt; List&lt;E&gt; find(Field&lt;Z&gt; field, Z value) &#123;</div><div class="line">        return dsl.selectFrom(table()).where(field.eq(value)).fetchInto(type());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public &lt;Z&gt; Optional&lt;E&gt; findOptional(Field&lt;Z&gt; field, Z value) &#123;</div><div class="line">        return dsl.selectFrom(table()).where(field.eq(value)).fetchOptionalInto(type());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public Optional&lt;E&gt; findOptional(Condition condition) &#123;</div><div class="line">        return select(condition).fetchOptionalInto(type());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public List&lt;E&gt; find(Condition... condition) &#123;</div><div class="line">        return select(condition).fetchInto(type());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public &lt;T extends E&gt; List&lt;T&gt; find(Condition condition, Class&lt;T&gt; subType) &#123;</div><div class="line">        return select(condition).fetchInto(subType);</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    public long countAll() &#123;</div><div class="line">        return dsl.selectCount().from(table()).fetchOneInto(long.class);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public &lt;Z&gt; long count(Field&lt;Z&gt; field, Z value) &#123;</div><div class="line">        return dsl.selectCount().from(table()).where(field.eq(value)).fetchOneInto(long.class);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public long count(Condition... condition) &#123;</div><div class="line">        return dsl.selectCount().from(table()).where(condition).fetchOneInto(long.class);</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    public boolean existsById(Integer id) &#123;</div><div class="line">        return exists(_pk(), id);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public &lt;Z&gt; boolean exists(Field&lt;Z&gt; field, Z value) &#123;</div><div class="line">        return count(field, value) &gt; 0;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public boolean exists(Condition... condition) &#123;</div><div class="line">        return count(condition) &gt; 0;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public boolean notExists(Condition... condition) &#123;</div><div class="line">        return count(condition) == 0;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /*------------------------------------å¢------------------------------------*/</div><div class="line">    public boolean insert(E entity) &#123;</div><div class="line">        return record(entity, false).insert() == 1;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * æ–°å¢è®°å½•å¹¶è¿”å›æ–°å¢åçš„è®°å½•</div><div class="line">     *</div><div class="line">     * @apiNote å…ˆæ‰§è¡Œinsert, å†æ‰§è¡Œselect</div><div class="line">     */</div><div class="line">    public &lt;T extends E&gt; E insertAndReturn(T entity) &#123;</div><div class="line">        return dsl.insertInto(table()).set(record(entity, false)).returning().fetchOne().into(type());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * æ–°å¢è®°å½•å¹¶è¿”å›ä¸»é”®ID</div><div class="line">     *</div><div class="line">     * @apiNote åªæ‰§è¡Œinsert</div><div class="line">     */</div><div class="line">    public &lt;T extends E&gt; Integer insertAndReturnId(T entity) &#123;</div><div class="line">        UpdatableRecord record = record(entity, false);</div><div class="line">        record.insert();</div><div class="line">        return record.getValue(_pk());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * ä¿å­˜ä¸€æ¡è®°å½•, å¦‚æœä¸»é”®/å”¯ä¸€é”®é‡å¤, åˆ™æ›´æ–°, å¦åˆ™æ–°å¢</div><div class="line">     *</div><div class="line">     * @param saveMap å¾…ä¿å­˜è®°å½•</div><div class="line">     * @return å—å½±å“è¡Œæ•°</div><div class="line">     */</div><div class="line">    public Integer save(Map&lt;? extends Field&lt;?&gt;, ?&gt; saveMap) &#123;</div><div class="line">        if (saveMap == null || saveMap.isEmpty()) &#123;</div><div class="line">            return 0;</div><div class="line">        &#125;</div><div class="line">        return dsl.insertInto(table()).set(saveMap).onDuplicateKeyUpdate().set(saveMap).execute();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /*------------------------------------æ”¹------------------------------------*/</div><div class="line">    public &lt;T extends E&gt; boolean update(T entity) &#123;</div><div class="line">        return record(entity, true).update() == 1;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public &lt;T extends E&gt; E updateAndReturn(T entity) &#123;</div><div class="line">        UpdatableRecord&lt;?&gt; record = record(entity, true);</div><div class="line">        Integer id = record.getValue(_pk());</div><div class="line">        if (id == null) &#123;</div><div class="line">            throw new IllegalArgumentException(&quot;id can not be null for update&quot;);</div><div class="line">        &#125;</div><div class="line">        record.update();</div><div class="line">        return select(_pk().eq(id)).fetchOneInto(type());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * @param record     å¾…æ›´æ–°çš„æ•°æ®</div><div class="line">     * @param conditions æ›´æ–°æ¡ä»¶</div><div class="line">     */</div><div class="line">    public int update(UpdatableRecord record, List&lt;Condition&gt; conditions) &#123;</div><div class="line">        return dsl.update(table()).set(record).where(conditions).execute();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * @param record     å¾…æ›´æ–°çš„æ•°æ®</div><div class="line">     * @param conditions æ›´æ–°æ¡ä»¶</div><div class="line">     */</div><div class="line">    public int update(UpdatableRecord record, Condition... conditions) &#123;</div><div class="line">        return dsl.update(table()).set(record).where(conditions).execute();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * @param map        å¾…æ›´æ–°çš„æ•°æ®</div><div class="line">     * @param conditions æ›´æ–°æ¡ä»¶</div><div class="line">     * @apiNote å¦‚æœå¤šä¸ªæ›´æ–°é¡¹ä¹‹é—´æœ‰ä¸¥æ ¼çš„å…ˆåé¡ºåº, åŠ¡å¿…ä½¿ç”¨æœ‰åºMap</div><div class="line">     */</div><div class="line">    public int update(Map&lt;? extends Field&lt;?&gt;, ?&gt; map, List&lt;Condition&gt; conditions) &#123;</div><div class="line">        return dsl.update(table()).set(map).where(conditions).execute();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * @param map       å¾…æ›´æ–°çš„æ•°æ®</div><div class="line">     * @param condition æ›´æ–°æ¡ä»¶</div><div class="line">     * @apiNote å¦‚æœå¤šä¸ªæ›´æ–°é¡¹ä¹‹é—´æœ‰ä¸¥æ ¼çš„å…ˆåé¡ºåº, åŠ¡å¿…ä½¿ç”¨æœ‰åºMap</div><div class="line">     */</div><div class="line">    public int update(Map&lt;? extends Field&lt;?&gt;, ?&gt; map, Condition condition) &#123;</div><div class="line">        return dsl.update(table()).set(map).where(condition).execute();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * æ›´æ–°æŒ‡å®šçš„å­—æ®µ</div><div class="line">     *</div><div class="line">     * @param conditions æ›´æ–°æ¡ä»¶</div><div class="line">     */</div><div class="line">    public &lt;Z&gt; int update(Field&lt;Z&gt; field, Z value, List&lt;Condition&gt; conditions) &#123;</div><div class="line">        return dsl.update(table()).set(field, value).where(conditions).execute();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * æ›´æ–°æŒ‡å®šçš„å­—æ®µ</div><div class="line">     *</div><div class="line">     * @param conditions æ›´æ–°æ¡ä»¶</div><div class="line">     */</div><div class="line">    public &lt;Z&gt; int update(Field&lt;Z&gt; field, Z value, Condition... conditions) &#123;</div><div class="line">        return dsl.update(table()).set(field, value).where(conditions).execute();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /*------------------------------------åˆ ------------------------------------*/</div><div class="line">    public boolean deleteById(Integer... ids) &#123;</div><div class="line">        if (ids.length == 1) &#123;</div><div class="line">            return dsl.delete(table()).where(_pk().eq(ids[0])).execute() == 1;</div><div class="line">        &#125;</div><div class="line">        return dsl.delete(table()).where(_pk().in(ids)).execute() == ids.length;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public &lt;Z&gt; int deleteBy(Field&lt;Z&gt; field, Z value) &#123;</div><div class="line">        return dsl.delete(table()).where(field.eq(value)).execute();</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    protected UpdatableRecord&lt;?&gt; record(E entity, boolean forUpdate) &#123;</div><div class="line">        Field&lt;Integer&gt; field = _pk();</div><div class="line">        UpdatableRecord&lt;?&gt; record = dsl.newRecord(table(), entity);</div><div class="line">        if (forUpdate &amp;&amp; field != null) &#123;</div><div class="line">            record.changed(field, false);</div><div class="line">        &#125;</div><div class="line">        // å¦‚æœå®ä½“å±æ€§ä¸ºNULL,ä½†æ•°æ®åº“åˆ—ä¸ºNOT NULL, åˆ™å…è®¸æ•°æ®åº“åº”ç”¨åˆ—çš„é»˜è®¤å€¼</div><div class="line">        int size = record.size();</div><div class="line">        for (int i = 0; i &lt; size; i++)</div><div class="line">            if (record.getValue(i) == null &amp;&amp; !record.field(i).getDataType().nullable())</div><div class="line">                record.changed(i, false);</div><div class="line">        return record;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    protected List&lt;UpdatableRecord&lt;?&gt;&gt; records(Collection&lt;E&gt; entities, boolean forUpdate) &#123;</div><div class="line">        return entities.stream().map(entity -&gt; record(entity, forUpdate)).collect(Collectors.toList());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private Field&lt;Integer&gt; _pk() &#123;</div><div class="line">        UniqueKey&lt;?&gt; key = table().getPrimaryKey();</div><div class="line">        if (key == null) &#123;</div><div class="line">            throw new DataAccessException(&quot;no primary key&quot;);</div><div class="line">        &#125;</div><div class="line">        Field&lt;?&gt;[] fields = key.getFieldsArray();</div><div class="line">        if (fields.length == 0) &#123;</div><div class="line">            throw new DataAccessException(&quot;no primary key&quot;);</div><div class="line">        &#125;</div><div class="line">        return fields[0].cast(Integer.class);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    protected SelectConditionStep&lt;? extends Record&gt; select(Condition... condition) &#123;</div><div class="line">        if (condition == null) &#123;</div><div class="line">            return dsl.selectFrom(table()).where(trueCondition());</div><div class="line">        &#125;</div><div class="line">        return dsl.selectFrom(table()).where(condition);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>AdminReporitory.class</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">@Repository</div><div class="line">public class AdminRepository extends AbstractSingleRepository&lt;AdminRecord&gt;&#123;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected Pair&lt;Class&lt;AdminRecord&gt;, Table&lt;? extends UpdatableRecord&gt;&gt; mapping() &#123;</div><div class="line">        return Pair.of(AdminRecord.class, ADMIN);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     *  æ ¹æ®idæŸ¥è¯¢ç”¨æˆ·</div><div class="line">     */</div><div class="line">    public List&lt;Admin&gt; findById(Integer id)&#123;</div><div class="line">        AdminQO query = AdminQO.builder().id(id).build();</div><div class="line">        return dsl.select().from(ADMIN).where(query.conditions()).fetchInto(Admin.class);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>æŸ¥è¯¢ç±»ï¼šAdminQO.class</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">@Getter</div><div class="line">@Builder</div><div class="line">public class AdminQO implements Conditional&#123;</div><div class="line">    private Integer id;</div><div class="line">    private String username;</div><div class="line">    private String password;</div><div class="line">    private String nickName;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public List&lt;Condition&gt; conditions() &#123;</div><div class="line">        List&lt;Condition&gt; conditions = Lists.newArrayList();</div><div class="line">        if(id != null)&#123;</div><div class="line">            conditions.add(ADMIN.ID.eq(id));</div><div class="line">        &#125;</div><div class="line">        if(username != null)&#123;</div><div class="line">            conditions.add(ADMIN.USERNAME.eq(username));</div><div class="line">        &#125;</div><div class="line">        if(password != null)&#123;</div><div class="line">            conditions.add(ADMIN.PASSWORD.eq(password));</div><div class="line">        &#125;</div><div class="line">        if(nickName != null)&#123;</div><div class="line">            conditions.add(ADMIN.NICK_NAME.eq(nickName));</div><div class="line">        &#125;</div><div class="line">        return conditions;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>Conditional.class</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">public interface Conditional &#123;</div><div class="line">    /**</div><div class="line">     * è·å–æŸ¥è¯¢æ¡ä»¶</div><div class="line">     */</div><div class="line">    List&lt;Condition&gt; conditions();</div><div class="line"></div><div class="line">    /**</div><div class="line">     * åˆå¹¶æŸ¥è¯¢æ¡ä»¶</div><div class="line">     */</div><div class="line">    default Condition toCondition() &#123;</div><div class="line">        return conditions().stream().reduce(Condition::and).orElse(trueCondition());</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>æµ‹è¯•ç±»</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * Created by jianweilin on 16/9/4.</div><div class="line"> */</div><div class="line">@SpringBootTest</div><div class="line">@RunWith(SpringRunner.class)</div><div class="line">public class AdminTest &#123;</div><div class="line">    @Autowired</div><div class="line">    private AdminRepository adminRepository;</div><div class="line"></div><div class="line">    @Test</div><div class="line">    public void findAdmin()&#123;</div><div class="line">        Integer id = 1;</div><div class="line">        List&lt;Admin&gt; admins = adminRepository.findById(id);</div><div class="line">        System.out.println(JSON.toJSON(admins));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è‡³æ­¤ï¼Œå®Œæˆ<code>SpringBoot</code>å’Œ<code>JOOQ</code>çš„é›†æˆã€‚è‹¥è¦å®ç°å¤šä¸ªæ•°æ®åº“ï¼Œå¯ä»¥åœ¨<code>JooqConfig.class</code>ä¸­é…ç½®ã€‚</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/03/ES6ä¹‹è§£æ„/" itemprop="url">
                  ES6ä¹‹è§£æ„
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">å‘è¡¨äº</span>
            <time itemprop="dateCreated" datetime="2016-09-03T22:12:10+08:00" content="2016-09-03">
              2016-09-03
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JavaScript/" itemprop="url" rel="index">
                    <span itemprop="name">JavaScript</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/03/ES6ä¹‹è§£æ„/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/03/ES6ä¹‹è§£æ„/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="ä»€ä¹ˆæ˜¯è§£æ„"><a href="#ä»€ä¹ˆæ˜¯è§£æ„" class="headerlink" title="ä»€ä¹ˆæ˜¯è§£æ„"></a>ä»€ä¹ˆæ˜¯è§£æ„</h3><p>ES6å…è®¸æŒ‰ç…§ä¸€å®šæ¨¡å¼ï¼Œä»æ•°ç»„å’Œå¯¹è±¡ä¸­æå–å€¼ï¼Œå¯¹å˜é‡è¿›è¡Œèµ‹å€¼ï¼Œè¿™è¢«ç§°ä¸ºè§£æ„ã€‚</p>
<h3 id="è§£æ„å®æˆ˜"><a href="#è§£æ„å®æˆ˜" class="headerlink" title="è§£æ„å®æˆ˜"></a>è§£æ„å®æˆ˜</h3><p><strong>æ¨¡å¼åŒ¹é…</strong></p>
<p><code>æ¡ˆä¾‹1ï¼šä»æ•°ç»„ä¸­æå–å€¼å¯¹å˜é‡èµ‹å€¼</code></p>
<p>ä»¥å‰ä¸ºå˜é‡èµ‹å€¼,åªèƒ½ç›´æ¥æŒ‡å®šå€¼ã€‚<code>var a = 1; var b = 2; var c = 3;</code>,è€ŒES6å…è®¸å†™æˆä¸‹é¢è¿™æ ·ï¼š<br><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-3/62199557.jpg" alt=""></p>
<p>å¯ä»¥ä»æ•°ç»„ä¸­æå–å€¼ï¼ŒæŒ‰ç…§ä½ç½®çš„å¯¹åº”å…³ç³»å¯¹å˜é‡èµ‹å€¼ã€‚</p>
<p><code>æ¡ˆä¾‹2ï¼šè¾“å‡ºæŒ‡å®šå‚æ•°</code></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-3/21789363.jpg" alt=""></p>
<p><code>æ¡ˆä¾‹3:è·å–é™¤ç¬¬ä¸€ä¸ªå…ƒç´ å¤–çš„æ•°ç»„å…ƒç´ </code></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-3/80722503.jpg" alt=""></p>
<p><code>æ¡ˆä¾‹4ï¼šéƒ¨åˆ†è§£æ„æˆåŠŸ</code></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-3/3511189.jpg" alt=""></p>
<p>å˜é‡è§£æ„ä¸æˆåŠŸä¸º<code>undefined</code>,æ•°ç»„è§£æ„ä¸æˆåŠŸä¸º<code>[]</code></p>
<p><code>æ¡ˆä¾‹5ï¼šæŒ‡å®šé»˜è®¤å€¼</code></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-3/22448401.jpg" alt=""></p>
<p><strong>å¯¹è±¡è§£æ„</strong></p>
<p><code>æ¡ˆä¾‹1ï¼šå¸¸è§„å¯¹è±¡è§£æ„</code></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-4/33755818.jpg" alt=""></p>
<p>å¯¹è±¡çš„è§£æ„ä¸æ•°ç»„æœ‰ä¸€ä¸ªé‡è¦çš„ä¸åŒï¼Œæ•°ç»„çš„å…ƒç´ æ˜¯æŒ‰æ¬¡åºæ’åˆ—çš„ï¼Œå˜é‡çš„å–å€¼ç”±å®ƒçš„ä½ç½®å†³å®šï¼Œè€Œå¯¹è±¡çš„å±æ€§æ²¡æœ‰æ¬¡åºï¼Œå˜é‡å¿…é¡»ä¸å±æ€§åŒåï¼Œæ‰èƒ½å–åˆ°æ­£ç¡®çš„å€¼ã€‚ç±»ä¼¼äº<code>Java</code>çš„<code>Map</code></p>
<p><code>æ¡ˆä¾‹2ï¼šå˜é‡åä¸å±æ€§åä¸ä¸€è‡´</code><br><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-4/50682927.jpg" alt=""></p>
<p>å¯¹è±¡çš„è§£æ„èµ‹å€¼çš„å†…éƒ¨æœºåˆ¶æ˜¯å…ˆæ‰¾åˆ°åŒåå±æ€§ï¼Œç„¶ååœ¨èµ‹ç»™å¯¹åº”çš„å˜é‡ï¼ŒçœŸæ­£è¢«èµ‹å€¼çš„æ˜¯åè€…å³<code>firstå’Œsecondå˜é‡</code></p>
<p><code>æ¡ˆä¾‹3ï¼šå£°æ˜é»˜è®¤å€¼</code><br><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-4/88888167.jpg" alt=""></p>
<p>é»˜è®¤å€¼ç”Ÿæ•ˆçš„æ¡ä»¶çš„æ¡ä»¶æ˜¯ï¼Œå¯¹è±¡çš„å±æ€§å€¼ä¸¥æ ¼ç­‰äºundefined;å¦‚ä¸‹è¿™ç§æƒ…å†µé»˜è®¤å€¼æ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ã€‚</p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-4/53746649.jpg" alt=""></p>
<p><strong>å­—ç¬¦ä¸²è§£æ„</strong></p>
<p><code>æ¡ˆä¾‹1ï¼šå­—ç¬¦ä¸²è¢«è½¬æ¢æˆç±»ä¼¼æ•°ç»„çš„å¯¹è±¡</code></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-4/27671791.jpg" alt=""></p>
<p><code>æ¡ˆä¾‹2ï¼šå­—ç¬¦ä¸²å±æ€§è§£æ„èµ‹å€¼</code></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-4/67194660.jpg" alt=""></p>
<p><strong>å‡½æ•°è§£æ„</strong></p>
<p><code>æ¡ˆä¾‹1ï¼šå¸¸è§„å‡½æ•°è§£æ„</code></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-4/49058450.jpg" alt=""><br>å‡½æ•°addçš„å‚æ•°å®é™…ä¸Šä¸æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè€Œæ˜¯é€šè¿‡è§£æ„å¾—åˆ°çš„å˜é‡xå’Œyï¼›</p>
<p><code>æ¡ˆä¾‹2ï¼šå‡½æ•°é»˜è®¤å€¼</code></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-4/16643905.jpg" alt=""></p>
<h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><ul>
<li>ES6æ ‡å‡†å…¥é—¨ - é˜®ä¸€å³°</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/03/ES6ä¹‹letå’Œconstå‘½ä»¤/" itemprop="url">
                  ES6ä¹‹letå’Œconstå‘½ä»¤
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">å‘è¡¨äº</span>
            <time itemprop="dateCreated" datetime="2016-09-03T09:44:51+08:00" content="2016-09-03">
              2016-09-03
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JavaScript/" itemprop="url" rel="index">
                    <span itemprop="name">JavaScript</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/03/ES6ä¹‹letå’Œconstå‘½ä»¤/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/03/ES6ä¹‹letå’Œconstå‘½ä»¤/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>æœ‰å¾ˆå¤šä¼šé—®<code>ECMAScriptå’ŒJavaScript</code>æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿè¦è®²æ¸…æ¥šè¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦å›é¡¾å†å²ï¼Œ<code>JavaScript</code>çš„åˆ›é€ è€…<code>Netscaptå…¬å¸</code>å°†JavaScriptäº¤ç»™å›½é™…æ ‡å‡†åŒ–ç»„ç»‡<code>ECMA</code>ï¼Œå¸Œæœ›è¿™ç§è¯­è¨€èƒ½æˆä¸ºå›½é™…æ ‡å‡†ï¼Œè€ŒJavaScriptæœ¬èº«å·²è¢«æ³¨å†Œä¸ºå•†æ ‡ï¼Œä¸ºäº†ä¿è¯è¿™é—¨è¯­è¨€çš„å¼€å‘æ€§å’Œä¸­ç«‹æ€§ï¼Œæ•…<code>ECMA</code>å°†å…¶å–åä¸º<code>ECMAScript</code>ã€‚å› æ­¤ï¼Œ<code>ECMAScript</code>æ˜¯<code>JavaScript</code>çš„è§„æ ¼ï¼Œè€Œ<code>JavaScript</code>æ˜¯<code>ECMAScript</code>çš„ä¸€ç§å®ç°ã€‚</p>
<p>â€‹    ä¸ºäº†æ›´å¥½çš„ç†Ÿæ‚‰ES6ï¼Œå°†ä¼šäº†è§£å…¶å„ä¸ªå‘½ä»¤çš„ç”¨æ³•ã€‚æœ¬æ–‡ä¸»è¦ä»‹ç»<code>let</code>å’Œ<code>const</code>å‘½ä»¤ã€‚</p>
<h3 id="letå‘½ä»¤"><a href="#letå‘½ä»¤" class="headerlink" title="letå‘½ä»¤"></a>letå‘½ä»¤</h3><p>1ã€letå‘½ä»¤å£°æ˜çš„å˜é‡åªåœ¨æ‰€åœ¨çš„ä»£ç å—å†…æœ‰æ•ˆ</p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-3/4545513.jpg" alt=""></p>
<p><strong>åº”ç”¨åœºæ™¯</strong></p>
<p><code>varå£°æ˜å˜é‡å…¨å±€æœ‰æ•ˆ</code></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-3/7696539.jpg" alt=""></p>
<p><code>letå£°æ˜å˜é‡ï¼Œå—çº§ä½œç”¨åŸŸæœ‰æ•ˆ</code></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-3/35110355.jpg" alt=""></p>
<hr>
<p>2ã€letå£°æ˜å˜é‡ä¸å­˜åœ¨å˜é‡æå‡</p>
<p><code>letå£°æ˜å˜é‡ä¸å­˜åœ¨æå‡</code></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-3/85962982.jpg" alt=""></p>
<p><code>varå£°æ˜å˜é‡ä¼šæå‡ï¼Œä½†æ²¡æœ‰èµ‹å€¼</code></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-3/67602230.jpg" alt=""></p>
<hr>
<p>3ã€åªè¦å—çº§ä½œç”¨åŸŸå†…å­˜åœ¨letå‘½ä»¤ï¼Œå®ƒæ‰€å£°æ˜çš„å˜é‡å°±ç»‘å®šè¿™ä¸ªåŒºåŸŸï¼Œä¸å†å—å¤–éƒ¨å½±å“ã€‚</p>
<p><code>æš‚æ—¶æ€§æ­»åŒº</code></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-3/30615566.jpg" alt=""></p>
<p>ä»£ç ä¸­å­˜åœ¨å…¨å±€å˜é‡tempï¼Œä½†åœ¨å—çº§ä½œç”¨åŸŸå†…ç”¨letåˆå£°æ˜äº†ä¸€ä¸ªå±€éƒ¨å˜é‡tempï¼Œå¯¼è‡´åè€…ç»‘å®šåˆ°è¿™ä¸ªå—çº§ä½œç”¨åŸŸï¼Œæ•…letåœ¨å£°æ˜å˜é‡å‰èµ‹å€¼ä¼šæŠ¥é”™ã€‚<br><code>å¯¹æ¯”1:ç”¨varå£°æ˜å˜é‡ğŸ¤”</code></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-3/76273734.jpg" alt=""></p>
<p><code>å¯¹æ¯”2:ç”¨varå˜é‡å£°æ˜ğŸ¤”</code></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-3/50001912.jpg" alt=""></p>
<p>æ­¤å¤„æœ‰ç–‘é—®ï¼Ÿå¯¹æ¯”1å’Œå¯¹æ¯”2è¾“å‡ºçš„ç»“æœä¸ºä½•ä¸ä¸€è‡´ï¼Ÿ</p>
<hr>
<p>4ã€letä¸å…è®¸åœ¨ç›¸åŒä½œç”¨åŸŸå†…é‡å¤å£°æ˜åŒä¸€ä¸ªå˜é‡</p>
<p><code>èŒƒä¾‹1âŒ</code><br><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-3/50645938.jpg" alt=""></p>
<p><code>èŒƒä¾‹2âŒ</code></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-3/25937104.jpg" alt=""></p>
<p><code>èŒƒä¾‹3âœ”ï¸ï¼šéåŒä¸€ä½œç”¨åŸŸï¼Œæ•…æ­£ç¡®</code><br><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-3/35044719.jpg" alt=""></p>
<hr>
<p>5ã€å—çº§ä½œç”¨åŸŸ</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆéœ€è¦å—çº§ä½œç”¨åŸŸ? ES5åªæœ‰å…¨å±€ä½œç”¨åŸŸå’Œå‡½æ•°ä½œç”¨åŸŸï¼Œæ²¡æœ‰å—çº§ä½œç”¨åŸŸï¼Œå¯èƒ½é€ æˆä»¥ä¸‹ä¸åˆç†çš„åœºæ™¯ï¼Ÿ</p>
</blockquote>
<p><code>åœºæ™¯1ï¼šå†…å­˜å˜é‡è¦†ç›–å¤–å±‚å˜é‡</code></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-3/65058203.jpg" alt=""></p>
<p><code>var</code>å£°æ˜çš„å˜é‡æå‡ï¼Œå¯¼è‡´å†…å±‚çš„<code>tep</code>å˜é‡è¦†ç›–äº†å¤–å±‚çš„<code>tep</code>å˜é‡ã€‚</p>
<p><code>åœºæ™¯2ï¼šè®¡æ•°çš„å¾ªç¯å˜é‡æ³„éœ²ä¸ºå…¨å±€å˜é‡</code></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-3/74483314.jpg" alt=""></p>
<p><code>ES6ä½¿ç”¨å—çº§ä½œç”¨åŸŸ</code><br><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-3/2688486.jpg" alt=""></p>
<h3 id="constå‘½ä»¤"><a href="#constå‘½ä»¤" class="headerlink" title="constå‘½ä»¤"></a>constå‘½ä»¤</h3><p>1ã€<code>const</code>æ˜¯å£°æ˜å¸¸é‡ï¼Œå£°æ˜ä¹‹åï¼Œä¸èƒ½æ”¹å˜å®ƒçš„å€¼ã€‚<br><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-3/3573997.jpg" alt=""></p>
<p>2ã€<code>const</code>å£°æ˜å˜é‡ï¼Œå¿…é¡»åˆå§‹åŒ–ï¼›<br><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-3/51809303.jpg" alt=""></p>
<p>3ã€<code>const</code>çš„æœ‰æ•ˆåŒºä¸ºå£°æ˜çš„å—çº§ä½œç”¨åŸŸï¼›<br><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-3/13875615.jpg" alt=""></p>
<p>4ã€<code>const</code>å˜é‡ä¸èƒ½ä¸»åŠ¨æå‡<br><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-3/9835388.jpg" alt=""></p>
<p>5ã€<code>const</code>å˜é‡ä¸èƒ½é‡å¤å£°æ˜<br><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-3/20566241.jpg" alt=""></p>
<p>6ã€<code>const</code>å£°æ˜æ•°ç»„ï¼Œåœ°å€ä¸å˜ï¼Œåœ°å€çš„å†…å®¹å¯å˜<br><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-3/33621124.jpg" alt=""></p>
<h3 id="å…¨å±€å˜é‡"><a href="#å…¨å±€å˜é‡" class="headerlink" title="å…¨å±€å˜é‡"></a>å…¨å±€å˜é‡</h3><p>1ã€<code>window.global ç­‰ä»·äº global</code><br><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-3/18776994.jpg" alt=""></p>
<p>2ã€<code>letå£°æ˜çš„å˜é‡ä¸å±äºå…¨å±€å±æ€§</code><br><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-3/69124545.jpg" alt=""></p>
<p>æœªå®Œå¾…ç»­â€¦</p>
<h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><ul>
<li>ES6æ ‡å‡†å…¥é—¨ - é˜®ä¸€å³°</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/02/Reactå…¥é—¨å®æˆ˜/" itemprop="url">
                  Reactå…¥é—¨å®æˆ˜
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">å‘è¡¨äº</span>
            <time itemprop="dateCreated" datetime="2016-09-02T00:00:06+08:00" content="2016-09-02">
              2016-09-02
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/React/" itemprop="url" rel="index">
                    <span itemprop="name">React</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/02/Reactå…¥é—¨å®æˆ˜/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/02/Reactå…¥é—¨å®æˆ˜/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Reactä»‹ç»"><a href="#Reactä»‹ç»" class="headerlink" title="Reactä»‹ç»"></a>Reactä»‹ç»</h3><p><code>React</code> æ˜¯ä¸€ä¸ª<code>Facebook</code> å’Œ<code>Instagram</code> ç”¨æ¥åˆ›å»ºç”¨æˆ·ç•Œé¢çš„<code>JavaScript</code> åº“ï¼Œå…¶<code>Github</code>åœ°å€æ˜¯<code>http://github.com/facebook/react</code>,æˆªè‡³ç›®å‰å·²ç»è·å–48369ä¸ªstarï¼Œè¯´æ˜äº†<code>React</code>å—åˆ°äº†å¾ˆå¤§çš„é‡è§†ã€‚</p>
<p><strong>Reactä¸»è¦ç‰¹ç‚¹</strong></p>
<ol>
<li><code>ä½œä¸ºUI</code>ï¼š<code>React</code>å¯ä»¥åªä½œä¸ºè§†å›¾<code>View</code>åœ¨MVCä¸­ä½¿ç”¨ï¼Œå¹¶ä¸”åœ¨å·²æœ‰é¡¹ç›®ä¸­ï¼Œå¾ˆå®¹æ˜“ä½¿ç”¨<code>React</code>å¼€å‘æ–°åŠŸèƒ½</li>
<li><code>è™šæ‹ŸDOM</code>:è¿™æ˜¯Reactçš„ä¸€ä¸ªäº®ç‚¹ï¼Œå¯ä»¥å¾ˆå¥½åœ°ä¼˜åŒ–è§†å›¾çš„æ¸²æŸ“å’Œåˆ·æ–°ã€‚ä»¥å‰æˆ‘ä»¬æ›´æ–°è§†å›¾æ—¶ï¼Œéœ€è¦å…ˆæ¸…ç©º<code>DOM</code>å®¹å™¨ä¸­çš„å†…å®¹ï¼Œç„¶åå°†æœ€æ–°çš„<code>DOM</code>å’Œæ•°æ®è¿½åŠ åˆ°å®¹å™¨ä¸­ï¼Œç°åœ¨<code>React</code>å°†è¿™ä¸€æ“ä½œæ”¾è¿›å†…å­˜ä¸­ï¼Œ<code>React</code>è®¤ä¸ºå†…å­˜çš„æ“ä½œè¿œæ¯”è§†å›¾å…¨éƒ¨æ›´æ–°æ¥çš„é«˜æ•ˆã€‚</li>
<li><code>æ•°æ®æµ</code>ï¼š<code>React</code>å®ç°äº†å•å‘çš„æ•°æ®æµï¼Œå¹¶ç›¸å¯¹äºä¼ ç»Ÿçš„æ•°æ®ç»‘å®šè€Œè¨€ï¼Œ<code>React</code>æ›´åŠ çµæ´»ï¼Œä¾¿æ·ã€‚</li>
</ol>
<h3 id="React-å®æˆ˜"><a href="#React-å®æˆ˜" class="headerlink" title="React å®æˆ˜"></a>React å®æˆ˜</h3><p><strong>HTMLæ¨¡æ¿</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html&gt;</div><div class="line">  &lt;head&gt;</div><div class="line">    &lt;script src=&quot;../build/react.js&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script src=&quot;../build/react-dom.js&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script src=&quot;../build/browser.min.js&quot;&gt;&lt;/script&gt;</div><div class="line">  &lt;/head&gt;</div><div class="line">  &lt;body&gt;</div><div class="line">    &lt;div id=&quot;example&quot;&gt;&lt;/div&gt;</div><div class="line">    &lt;script type=&quot;text/babel&quot;&gt;</div><div class="line">  	// ** our code goes here !**</div><div class="line">    &lt;/script&gt;</div><div class="line">  &lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p><code>sciptæ ‡ç­¾</code>çš„<code>type</code>å±æ€§ä¸º<code>type/babel</code>ï¼Œè¿™æ˜¯å› ä¸ºReactç‹¬æœ‰çš„JSXè¯­æ³•ä¸<code>JavaScript</code>ä¸å…¼å®¹ã€‚ä¸Šè¿°ä»£ç ä¸€å…±ç”¨äº†ä¸‰ä¸ªåº“ï¼š<code>react.js</code>ã€<code>react-dom.js</code>ã€<code>Browser.js</code>ï¼Œä»–ä»¬å¿…é¡»é¦–å…ˆåŠ è½½ï¼Œ<code>react.js</code>æ˜¯<code>React</code>çš„æ ¸å¿ƒåº“ï¼Œ<code>react-dom.js</code>æ˜¯æä¾›ä¸<code>DOM</code>ç›¸å…³çš„åŠŸèƒ½ï¼Œ<code>Browser.js</code>æ˜¯å°†JSXè¯­æ³•è½¬åŒ–ä¸º<code>JavaScript</code>è¯­æ³•,è¿™ä¸€æ­¥å¾ˆè€—æ—¶ï¼Œå®é™…ä¸Šçº¿åº”è¯¥æ”¾åˆ°æœåŠ¡å™¨å®Œæˆã€‚</p>
<p><strong>Render &amp; JSX</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html&gt;</div><div class="line">  &lt;head&gt;</div><div class="line">    &lt;script src=&quot;../build/react.js&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script src=&quot;../build/react-dom.js&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script src=&quot;../build/browser.min.js&quot;&gt;&lt;/script&gt;</div><div class="line">  &lt;/head&gt;</div><div class="line">  &lt;body&gt;</div><div class="line">    &lt;div id=&quot;example&quot;&gt;&lt;/div&gt;</div><div class="line">    &lt;script type=&quot;text/babel&quot;&gt;</div><div class="line">      ReactDOM.render(</div><div class="line">        &lt;h1&gt;Hello, world!&lt;/h1&gt;,</div><div class="line">        document.getElementById(&apos;example&apos;)</div><div class="line">      );</div><div class="line">    &lt;/script&gt;</div><div class="line">  &lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p><code>JSX</code>æ˜¯Reactæ¨¡æ¿è¯­æ³•ï¼Œå®ƒå…è®¸åœ¨<code>JavaScript</code>ä¸­æ’å…¥<code>HTMLè¯­è¨€</code>ï¼Œ<code>ReactDOM.reader()</code>ç”¨äºå°†æ¨¡æ¿è½¬åŒ–ä¸º<code>HTML</code>è¯­è¨€ï¼Œå¹¶æ’å…¥åˆ°æŒ‡å®šçš„<code>DOM</code>èŠ‚ç‚¹ã€‚</p>
<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-2/93411408.jpg" alt=""></p>
<p><strong>åœ¨JSXä¸­ä½¿ç”¨JavaScript</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html&gt;</div><div class="line">  &lt;head&gt;</div><div class="line">    &lt;script src=&quot;../build/react.js&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script src=&quot;../build/react-dom.js&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script src=&quot;../build/browser.min.js&quot;&gt;&lt;/script&gt;</div><div class="line">  &lt;/head&gt;</div><div class="line">  &lt;body&gt;</div><div class="line">    &lt;div id=&quot;example&quot;&gt;&lt;/div&gt;</div><div class="line">    &lt;script type=&quot;text/babel&quot;&gt;</div><div class="line">      var names = [&apos;Alice&apos;, &apos;Emily&apos;, &apos;Kate&apos;];</div><div class="line">      ReactDOM.render(</div><div class="line">        &lt;div&gt;</div><div class="line">        &#123;</div><div class="line">          names.map(function (name) &#123;</div><div class="line">            return &lt;div&gt;Hello, &#123;name&#125;!&lt;/div&gt;</div><div class="line">          &#125;)</div><div class="line">        &#125;</div><div class="line">        &lt;/div&gt;,</div><div class="line">        document.getElementById(&apos;example&apos;)</div><div class="line">      );</div><div class="line">    &lt;/script&gt;</div><div class="line">  &lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p><code>JSX</code>çš„åŸºæœ¬è¯­æ³•è§„åˆ™ï¼šé‡åˆ°HTMLæ ‡ç­¾ï¼ˆä»¥ <code>&lt;</code>å¼€å¤´ï¼‰ï¼Œå°±ç”¨<code>HTML</code>è§„åˆ™è§£æï¼Œé‡åˆ°ä»£ç å—(ä»¥<code>{</code>å¼€å¤´)ï¼Œå°±ç”¨<code>JavaScript</code>è§£æã€‚</p>
<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-2/82806925.jpg" alt=""></p>
<hr>
<p><strong>ç»„ä»¶</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html&gt;</div><div class="line">  &lt;head&gt;</div><div class="line">    &lt;script src=&quot;../build/react.js&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script src=&quot;../build/react-dom.js&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script src=&quot;../build/browser.min.js&quot;&gt;&lt;/script&gt;</div><div class="line">  &lt;/head&gt;</div><div class="line">  &lt;body&gt;</div><div class="line">    &lt;div id=&quot;example&quot;&gt;&lt;/div&gt;</div><div class="line">    &lt;script type=&quot;text/babel&quot;&gt;</div><div class="line">      var HelloMessage = React.createClass(&#123;</div><div class="line">        render: function() &#123;</div><div class="line">          return &lt;h1&gt;Hello &#123;this.props.name&#125;&lt;/h1&gt;;</div><div class="line">        &#125;</div><div class="line">      &#125;);</div><div class="line"></div><div class="line">      ReactDOM.render(</div><div class="line">        &lt;HelloMessage name=&quot;John&quot; /&gt;,</div><div class="line">        document.getElementById(&apos;example&apos;)</div><div class="line">      );</div><div class="line">    &lt;/script&gt;</div><div class="line">  &lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p><code>React</code>è¿è¡Œå°†ä»£ç å°è£…æˆç»„ä»¶ï¼Œç„¶ååƒæ’å…¥æ™®é€š<code>HTML</code>æ ‡ç­¾ä¸€æ ·ï¼Œåœ¨ç½‘é¡µä¸­æ’å…¥è¿™ä¸ªç»„ä»¶ï¼Œ<code>React.createClass</code>ç”¨äºç”Ÿæˆä¸€ä¸ªç»„ä»¶ç±»ã€‚æ³¨æ„ï¼Œç»„ä»¶ç±»çš„ç¬¬ä¸€ä¸ªå­—æ¯å¿…é¡»å¤§å†™ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼Œæ¯”å¦‚<code>HelloMessage</code>ä¸èƒ½å†™æˆ<code>helloMessage</code>,å¦å¤–ï¼Œç»„ä»¶ç±»åªèƒ½åŒ…å«ä¸€ä¸ªé¡¶å±‚æ ‡ç­¾ï¼Œå¦åˆ™ä¹Ÿä¼šæŠ¥é”™ã€‚</p>
<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-2/87496917.jpg" alt=""></p>
<p>æœªå®Œå¾…ç»­â€¦.</p>
<h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><ul>
<li><code>React Native</code> å…¥é—¨ä¸å®æˆ˜</li>
</ul>
<ul>
<li><a href="http://www.ruanyifeng.com/blog/2015/03/react.html" target="_blank" rel="external"><code>React</code>å…¥é—¨å®ä¾‹æ•™ç¨‹</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/01/iTerm2å·¥å…·ä»‹ç»/" itemprop="url">
                  iTerm2å·¥å…·ä»‹ç»
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">å‘è¡¨äº</span>
            <time itemprop="dateCreated" datetime="2016-09-01T22:01:00+08:00" content="2016-09-01">
              2016-09-01
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Mac/" itemprop="url" rel="index">
                    <span itemprop="name">Mac</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/01/iTerm2å·¥å…·ä»‹ç»/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/01/iTerm2å·¥å…·ä»‹ç»/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="iTerm2ç®€ä»‹"><a href="#iTerm2ç®€ä»‹" class="headerlink" title="iTerm2ç®€ä»‹"></a>iTerm2ç®€ä»‹</h3><p><code>iTerm2</code>æ˜¯Macä¸‹æœ€å¥½çš„ç»ˆç«¯å·¥å…·ï¼Œä¸ºäº†åœ¨å·¥ä½œä¸­ï¼Œæ›´é«˜æ•ˆçš„åˆ©ç”¨å®ƒï¼Œè®©æˆ‘ä»¬æ¥ç†Ÿæ‚‰è¿™ä¸ªå·¥å…·ã€‚ä»¥ä¸‹å°†ä»‹ç»å…¶å¸¸ç”¨çš„åŠŸèƒ½ã€‚</p>
<p><strong>æŸ¥è¯¢</strong></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-1/36067323.jpg" alt=""></p>
<p>åœºæ™¯ï¼š<code>ç”¨äºæœç´¢å…³é”®å­—ï¼ŒæŒ‰Tabé”®å¯ä»¥è‡ªåŠ¨è¡¥å…¨å•è¯ï¼Œä¸”è¡¥å…¨çš„å•è¯å¯ä»¥ç›´æ¥ç²˜è´´åˆ°ä»–å¤„</code></p>
<p>å¿«æ·é”®ï¼š<code>command + f</code></p>
<p><strong>åˆ‡å±</strong></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-1/33677033.jpg" alt=""></p>
<p>åœºæ™¯æè¿°ï¼š<code>æ°´å¹³åˆ†å‰²ï¼Œä¸æƒ³æ–°å»ºçª—å£ï¼Œå°†ä¸€ä¸ªçª—å£åˆ†å‰²ä¸ºä¸Šä¸‹ä¸¤éƒ¨åˆ†</code></p>
<p>å¿«æ·é”®ï¼š<code>command + shift + d</code></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-1/28476179.jpg" alt=""></p>
<p>åœºæ™¯æè¿°ï¼š<code>å‚ç›´åˆ†å‰²</code></p>
<p>å¿«æ·é”®ï¼š<code>command + d</code></p>
<p><strong>å¿«é€Ÿå‘¼å‡º<code>iTerm2</code></strong></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-1/40272002.jpg" alt=""></p>
<p>åœºæ™¯ï¼š<code>åœ¨æµè§ˆç½‘é¡µæ—¶ï¼Œå°†æ§åˆ¶å°æ‚¬æµ®äºç½‘é¡µä¹‹ä¸Šï¼Œä¸”å‘ˆç°é€æ˜çŠ¶</code></p>
<p><code>å¿«æ·é”®è®¾ç½®</code></p>
<p><img src="http://oc5a5l0a0.bkt.clouddn.com/16-9-1/57025295.jpg" alt=""></p>
<p>å¿«æ·é”®ï¼š<code>command + \</code>å¿«é€Ÿå‘¼å‡º<code>iTerm2</code></p>
<p><strong>å…¨å±åˆ‡æ¢</strong></p>
<p>å¿«æ·é”®ï¼š<code>command + enter</code></p>
<h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><ul>
<li><a href="https://www.iterm2.com/features.html" target="_blank" rel="external">iTerm2å®˜æ–¹æ–‡æ¡£</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://oc5a5l0a0.bkt.clouddn.com/16-10-7/31807945.jpg"
               alt="æµäº‘" />
          <p class="site-author-name" itemprop="name">æµäº‘</p>
          <p class="site-description motion-element" itemprop="description">æ¯å¤©è¿›æ­¥ä¸€ç‚¹</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">140</span>
              <span class="site-state-item-name">æ—¥å¿—</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">29</span>
                <span class="site-state-item-name">åˆ†ç±»</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">31</span>
                <span class="site-state-item-name">æ ‡ç­¾</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">æµäº‘</span>
</div>

<div class="powered-by">
  ç”± <a class="theme-link" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨
</div>

<div class="theme-info">
  ä¸»é¢˜ -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"jianwl"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    <script src="/vendors/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  






  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });

                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  

</body>
</html>
